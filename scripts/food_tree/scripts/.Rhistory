#geom_hline(yintercept = f_q50, linetype = 'dashed') +
#geom_hline(yintercept = f_q75, linetype = 'dashed') +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(colour = "grey85"))
sweets_time <- sweets %>%
ggplot(aes(x = fdrt, y = sweetsum )) +
geom_point() +
geom_line(aes(x = fdrt, y = sweetsum), linetype = 'solid', size = 0.5, col = 'black') +
xlim(xmin, xmax) +
labs(x = '',
y = 'Sweets intake',
title = 'Sweets intake') +
theme_classic() +
# ylim(lowest_daily_sweet_intake, highest_daily_sweet_intake)+
#scale_y_sqrt() +
#geom_hline(yintercept = s_q25, linetype = 'dashed') +
#geom_hline(yintercept = s_q50, linetype = 'dashed') +
#geom_hline(yintercept = s_q75, linetype = 'dashed') +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(colour = "grey85"))
abx_time <- ggplot(abx, aes(x = startdrt, y = yval, xend = stopdrt, yend = yval, label = drugfull )) +
geom_segment(
size = 0.5, lineend = 'round',
arrow = arrow(length = unit(0.05, "inches"))
) +
geom_text(hjust = 'outside', nudge_y = -0.1, nudge_x = 5, size = 2) +
xlim(xmin, xmax) +
labs(x = '',
y = '',
title = 'Antibiotics') +
theme_classic() +
theme(aspect.ratio=1,
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
panel.grid.major.x = element_line(color = "grey85"))
irep = growth %>%
ggplot(aes(x = sdrt, y = aveirep )) +
geom_point() +
labs(title = str_glue('{}')) +
#geom_hline(yintercept = irep_q25, linetype = 'dashed') +
#geom_hline(yintercept = irep_q50, linetype = 'dashed') +
#geom_hline(yintercept = irep_q75, linetype = 'dashed') +
xlim(xmin, xmax) +
#ylim(1, irep_highest) +
labs(x = '',
y = 'Average replication rate',
title = 'Klebsiella')+
theme_classic()+
theme(aspect.ratio=1,
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(color = "grey85"))
pkle_ver <- plot_grid(abx_time,
sweets_time,
fruit_time,
irep,
copies,
byrow = T,
ncol = 1, axis = 'ltbr', align = 'hv')
pkle_ver
ggsave('../figs/paper/095_irep_kle_vertical.pdf', width = 130,
height = 250, units = 'mm', dpi = 400, plot = pkle_ver)
knitr::opts_chunk$set(echo = TRUE)
dtb <- read_csv('../data/cleaned_diet_data/FINAL_97_with_code_all_foods_drt_with_EN_finalized.csv')
all_fruit <- dtb %>%
mutate(Food_code = as.character(Food_code) ) %>%
filter(str_detect(Food_code, '^6')) %>%
group_by(mrn, fdrt) %>%
summarise(fruitdaily = sum(dehydrated_weight))
View(all_fruit)
all_fruit %>% write_csv('../data/075_all_daily_fruit.csv')
all_sweet <- dtb %>%
mutate(Food_code = as.character(Food_code) ) %>%
filter(str_detect(Food_code, '^9')) %>%
group_by(mrn, fdrt) %>%
summarise(sweetdaily = sum(dehydrated_weight))
all_sweet %>% write_csv('../data/075_all_daily_sweet.csv')
all_fruit <- read_csv('../data/075_all_daily_fruit.csv')
all_sweet <- read_csv('../data/075_all_daily_sweet.csv')
all_sweet
highest_daily_fruit_intake <- ceiling( max(all_fruit$fruitdaily))
lowest_daily_fruit_intake <- floor( min(all_fruit$fruitdaily))
highest_daily_sweet_intake <- ceiling( max(all_sweet$sweetdaily))
lowest_daily_sweet_intake <- floor( min(all_sweet$sweetdaily))
xmin <- lowerday - 1
xmax <- highday + 1
# plotting
copies <- cts_ %>%
ggplot(aes(x = sdrt, y = kle_copy )) +
geom_point() +
geom_line(aes(x = sdrt, y = kle_copy), linetype = 'solid', size = 0.5, col = 'black') +
xlim(xmin, xmax) +
labs(x = 'Day relative to transplant',
y = 'Klebsiella copy\nnumbers',
title = 'Copy numbers') +
theme_classic() +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
panel.grid.major.x = element_line(colour = "grey85"))
fruit_time <- fruit %>%
ggplot(aes(x = fdrt, y = fruitsum )) +
geom_point() +
geom_line(aes(x = fdrt, y = fruitsum), linetype = 'solid', size = 0.5, col = 'black') +
xlim(xmin, xmax) +
labs(x = '',
y = 'Fruit intake',
title = 'Fruit intake') +
theme_classic() +
ylim(lowest_daily_fruit_intake, highest_daily_fruit_intake)+
geom_hline(yintercept = quantile(x = all_fruit$fruitdaily, 0.25), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_fruit$fruitdaily, 0.5), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_fruit$fruitdaily, 0.75), linetype = 'dashed') +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(colour = "grey85"))
sweets_time <- sweets %>%
ggplot(aes(x = fdrt, y = sweetsum )) +
geom_point() +
geom_line(aes(x = fdrt, y = sweetsum), linetype = 'solid', size = 0.5, col = 'black') +
xlim(xmin, xmax) +
labs(x = '',
y = 'Sweets intake',
title = 'Sweets intake') +
theme_classic() +
ylim(lowest_daily_sweet_intake, highest_daily_sweet_intake)+
geom_hline(yintercept = quantile(x = all_sweet$sweetdaily, 0.25), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_sweet$sweetdaily, 0.5), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_sweet$sweetdaily, 0.75), linetype = 'dashed') +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(colour = "grey85"))
abx_time <- ggplot(abx, aes(x = startdrt, y = yval, xend = stopdrt, yend = yval, label = drugfull )) +
geom_segment(
size = 0.5, lineend = 'round',
arrow = arrow(length = unit(0.05, "inches"))
) +
geom_text(hjust = 'outside', nudge_y = -0.1, nudge_x = 5, size = 2) +
xlim(xmin, xmax) +
labs(x = '',
y = '',
title = 'Antibiotics') +
theme_classic() +
theme(aspect.ratio=1,
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
panel.grid.major.x = element_line(color = "grey85"))
irep = growth %>%
ggplot(aes(x = sdrt, y = aveirep )) +
geom_point() +
labs(title = str_glue('{}')) +
#geom_hline(yintercept = irep_q25, linetype = 'dashed') +
#geom_hline(yintercept = irep_q50, linetype = 'dashed') +
#geom_hline(yintercept = irep_q75, linetype = 'dashed') +
xlim(xmin, xmax) +
#ylim(1, irep_highest) +
labs(x = '',
y = 'Replication rate',
title = 'Klebsiella')+
theme_classic()+
theme(aspect.ratio=1,
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(color = "grey85"))
pkle_ver <- plot_grid(abx_time,
sweets_time,
fruit_time,
irep,
copies,
byrow = T,
ncol = 1, axis = 'ltbr', align = 'hv')
pkle_ver
ggsave('../figs/paper/095_irep_kle_vertical.pdf', width = 130,
height = 250, units = 'mm', dpi = 400, plot = pkle_ver)
View(combined)
View(combined)
all_kle_irep <- combined %>%
filter(str_detect(best_species, 'Klebsiella'))
View(all_kle_irep)
all_kle_irep
xmin <- lowerday - 1
xmax <- highday + 1
# plotting
copies <- cts_ %>%
ggplot(aes(x = sdrt, y = kle_copy )) +
geom_point() +
geom_line(aes(x = sdrt, y = kle_copy), linetype = 'solid', size = 0.5, col = 'black') +
xlim(xmin, xmax) +
labs(x = 'Day relative to transplant',
y = 'Klebsiella copy\nnumbers',
title = 'Copy numbers') +
theme_classic() +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
panel.grid.major.x = element_line(colour = "grey85"))
fruit_time <- fruit %>%
ggplot(aes(x = fdrt, y = fruitsum )) +
geom_point() +
geom_line(aes(x = fdrt, y = fruitsum), linetype = 'solid', size = 0.5, col = 'black') +
xlim(xmin, xmax) +
labs(x = '',
y = 'Fruit intake',
title = 'Fruit intake') +
theme_classic() +
ylim(lowest_daily_fruit_intake, highest_daily_fruit_intake)+
geom_hline(yintercept = quantile(x = all_fruit$fruitdaily, 0.25), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_fruit$fruitdaily, 0.5), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_fruit$fruitdaily, 0.75), linetype = 'dashed') +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(colour = "grey85"))
sweets_time <- sweets %>%
ggplot(aes(x = fdrt, y = sweetsum )) +
geom_point() +
geom_line(aes(x = fdrt, y = sweetsum), linetype = 'solid', size = 0.5, col = 'black') +
xlim(xmin, xmax) +
labs(x = '',
y = 'Sweets intake',
title = 'Sweets intake') +
theme_classic() +
ylim(lowest_daily_sweet_intake, highest_daily_sweet_intake)+
geom_hline(yintercept = quantile(x = all_sweet$sweetdaily, 0.25), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_sweet$sweetdaily, 0.5), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_sweet$sweetdaily, 0.75), linetype = 'dashed') +
theme(aspect.ratio=1,
plot.margin = margin(l=-0.8,unit="cm"),
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(colour = "grey85"))
abx_time <- ggplot(abx, aes(x = startdrt, y = yval, xend = stopdrt, yend = yval, label = drugfull )) +
geom_segment(
size = 0.5, lineend = 'round',
arrow = arrow(length = unit(0.05, "inches"))
) +
geom_text(hjust = 'outside', nudge_y = -0.1, nudge_x = 5, size = 2) +
xlim(xmin, xmax) +
labs(x = '',
y = '',
title = 'Antibiotics') +
theme_classic() +
theme(aspect.ratio=1,
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
axis.text.y=element_blank(),
panel.grid.major.x = element_line(color = "grey85"))
irep = growth %>%
ggplot(aes(x = sdrt, y = aveirep )) +
geom_point() +
labs(title = str_glue('{}')) +
geom_hline(yintercept = quantile(x = all_kle_irep$aveirep, 0.25), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_kle_irep$aveirep, 0.5), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_kle_irep$aveirep, 0.75), linetype = 'dashed') +
xlim(xmin, xmax) +
#ylim(1, irep_highest) +
labs(x = '',
y = 'Replication rate',
title = 'Klebsiella')+
theme_classic()+
theme(aspect.ratio=1,
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(color = "grey85"))
pkle_ver <- plot_grid(abx_time,
sweets_time,
fruit_time,
irep,
copies,
byrow = T,
ncol = 1, axis = 'ltbr', align = 'hv')
pkle_ver
ggsave('../figs/paper/095_irep_kle_vertical.pdf', width = 130,
height = 250, units = 'mm', dpi = 400, plot = pkle_ver)
all_kle_irep
all_kle_irep
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot')
all_kle
all_kle_irep
irep_highest <- ceiling( max(all_kle_irep$aveirep))
irep = growth %>%
ggplot(aes(x = sdrt, y = aveirep )) +
geom_point() +
labs(title = str_glue('{}')) +
geom_hline(yintercept = quantile(x = all_kle_irep$aveirep, 0.25), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_kle_irep$aveirep, 0.5), linetype = 'dashed') +
geom_hline(yintercept = quantile(x = all_kle_irep$aveirep, 0.75), linetype = 'dashed') +
xlim(xmin, xmax) +
ylim(1, irep_highest) +
labs(x = '',
y = 'Replication rate',
title = 'Klebsiella')+
theme_classic()+
theme(aspect.ratio=1,
#axis.text.x=element_blank(),
#axis.ticks.x=element_blank(),
panel.grid.major.x = element_line(color = "grey85"))
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot')
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=5,
plot.margin = margin(l=-0.8,unit="cm"),
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank() )
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=5,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank() )
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.text.x = element_blank() )
all_kle
irep
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank() )
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank() )
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid = element_blank(),
axis.text.x = element_blank() )
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.text.x = element_blank() )
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
line = element_blank(),
axis.text.x = element_blank() )
all_kle
# the boxes of the populations
all_kle <- all_kle_irep %>%
ggviolin(y = 'aveirep', add = 'boxplot') +
theme_classic() +
ylim(1, irep_highest) +
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
line = element_blank(),
axis.text.x = element_blank() )
all_kle
all_sweet
violin9 <- all_sweet %>%
ggviolin(y = 'sweetdaily', add = 'boxplot') +
theme_classic() +
ylim(lowest_daily_sweet_intake, highest_daily_sweet_intake)+
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
line = element_blank(),
axis.text.x = element_blank() )
violin9
all_sweet
all_fruit
violin6 <- all_fruit %>%
ggviolin(y = 'fruitdaily', add = 'boxplot') +
theme_classic() +
ylim(lowest_daily_fruit_intake, highest_daily_fruit_intake)+
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
line = element_blank(),
axis.text.x = element_blank() )
violin6
pkle_ver <- plot_grid(abx_time, NA,
sweets_time, violin9,
fruit_time, violin6,
irep, all_kle,
copies,NA,
byrow = T,
ncol = 2, axis = 'ltbr', align = 'hv')
pkle_ver
ggsave('../figs/paper/095_irep_kle_vertical.pdf', width = 130,
height = 250, units = 'mm', dpi = 400, plot = pkle_ver)
pkle_ver <- plot_grid(abx_time, NA,
sweets_time, violin9,
fruit_time, violin6,
irep, all_kle,
copies,NA,
byrow = T,
ncol = 2, axis = 'ltbr', align = 'hv', rel_widths = c(1, 0.3))
pkle_ver
ggsave('../figs/paper/095_irep_kle_vertical.pdf', width = 130,
height = 250, units = 'mm', dpi = 400, plot = pkle_ver)
pkle_ver <- plot_grid(abx_time, NA,
sweets_time, violin9,
fruit_time, violin6,
irep, all_kle,
copies,NA,
byrow = T,
ncol = 2, axis = 'ltbr', align = 'hv', rel_widths = c(1, 0.5))
pkle_ver
ggsave('../figs/paper/095_irep_kle_vertical.pdf', width = 130,
height = 250, units = 'mm', dpi = 400, plot = pkle_ver)
violin6 <- all_fruit %>%
ggviolin(y = 'fruitdaily', add = 'boxplot') +
theme_classic() +
ylim(lowest_daily_fruit_intake, highest_daily_fruit_intake)+
theme(aspect.ratio=6,
axis.ticks.x=element_blank(),
axis.title.x = element_blank(),
axis.ticks.y=element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
line = element_blank(),
axis.text.x = element_blank() )
violin6
pkle_ver <- plot_grid(abx_time, NA,
sweets_time, violin9,
fruit_time, violin6,
irep, all_kle,
copies,NA,
byrow = T,
ncol = 2, axis = 'ltbr', align = 'hv', rel_widths = c(1, 0.5))
