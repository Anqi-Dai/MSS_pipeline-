theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=50, hjust=1, size=13),
axis.text.y=element_text(size=12),
axis.title=element_text(size=axis_title_size),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
legend.position = 'top',
legend.key = element_rect( colour = "gray50"),
panel.background = element_blank())
ggsave('../figs/paper/054_heatmap_family_24_ggplot.pdf', width = 10, height = 4)
ggsave('../figs/paper/054_heatmap_family_24_ggplot.pdf', width = 10, height = 4)
col_key <- post_res %>%
ungroup() %>%
distinct(color) %>%
pull(color)
names(col_key) <- col_key
axis_text_size <- 13
axis_title_size <- 10
ggplot(post_res_ordered, aes(x = family, y = item)) +
geom_tile(aes(fill = color,  x = family, y =  item), alpha = 0.5, color='white', width=0.95, height=0.95) +
# geom_text(aes(label = round(meanperitem, 3))) +
geom_text(aes(label = mark, x = family,y =  item),
nudge_y = -0.1, nudge_x = 0,size = 5) +
scale_fill_manual(values = col_key, labels = c('Less than 75% CI crosses 0','75% CI < 0 negative','75% CI > 0 positive')) +
theme_light() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=50, hjust=1, size=11),
axis.text.y=element_text(size=11),
axis.title=element_text(size=axis_title_size),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
legend.position = 'top',
legend.key = element_rect( colour = "gray50"),
panel.background = element_blank())
ggsave('../figs/paper/054_heatmap_family_24_ggplot.pdf', width = 10, height = 4)
ggsave('../figs/paper/054_heatmap_family_24_ggplot.pdf', width = 8, height = 5)
ggsave('../figs/paper/054_heatmap_family_24_ggplot.pdf', width = 8, height = 4.5)
ggsave('../figs/paper/054_heatmap_family_24_ggplot.pdf', width = 8, height = 5)
col_key <- post_res %>%
ungroup() %>%
distinct(color) %>%
pull(color)
names(col_key) <- col_key
axis_text_size <- 13
axis_title_size <- 10
ggplot(post_res_ordered, aes(x = family, y = item)) +
geom_tile(aes(fill = color,  x = family, y =  item), alpha = 0.5, color='white', width=0.95, height=0.95) +
# geom_text(aes(label = round(meanperitem, 3))) +
geom_text(aes(label = mark, x = family,y =  item),
nudge_y = -0.1, nudge_x = 0,size = 5) +
scale_fill_manual(values = col_key, labels = c('Less than 75% CI crosses 0','75% CI < 0 negative','75% CI > 0 positive')) +
theme_light() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=50, hjust=1, size=11),
axis.text.y=element_text(size=11),
axis.title=element_text(size=axis_title_size),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
legend.position = 'top',
legend.key = element_rect( colour = "gray50"),
panel.background = element_blank())
ggsave('../figs/paper/054_heatmap_family_24_ggplot.pdf', width = 8, height = 5)
# the heatmap about the binary variables
post_bi_res <- post_df %>%
select(family, starts_with('b_')) %>%
select(-starts_with('b_fg'), -b_Intercept) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(family, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item_name = case_when(
item ==  'b_inten_non' ~ 'Intensity: nonablative',
item == 'b_inten_ab' ~ 'Intensity: ablative',
item ==  'b_inten_re' ~ 'Intensity: reduced',
item ==  'b_empiricalTRUE' ~ 'Empirical abx exposure',
item == 'b_TPNTRUE' ~ 'TPN exposure',
item ==  'b_ENTRUE' ~ 'EN exposure'
)) %>%
mutate(family = str_replace(family, '._Incertae_Sedis',''))
ggplot(post_bi_res, aes(x = family, y = item_name)) +
geom_tile(aes(fill = color,  x = family, y =  item_name), alpha = 0.5, color='white', width=0.95, height=0.95) +
geom_text(aes(label = mark, x = family,y =  item_name),
nudge_y = -0.1, nudge_x = 0,size = 5) +
scale_fill_manual(values = col_key, labels = c('Effects too small','75% CI < 0 negative','75% CI > 0 positive')) +
theme_light() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=45, hjust=1, size=13),
axis.text.y=element_text(size=12),
axis.title=element_text(size=axis_title_size),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
legend.position = 'top',
legend.key = element_rect( colour = "gray50"),
panel.background = element_blank())
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 10, height = 4)
# the heatmap about the binary variables
post_bi_res <- post_df %>%
select(family, starts_with('b_')) %>%
select(-starts_with('b_fg'), -b_Intercept) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(family, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item_name = case_when(
item ==  'b_inten_non' ~ 'Intensity: nonablative',
item == 'b_inten_ab' ~ 'Intensity: ablative',
item ==  'b_inten_re' ~ 'Intensity: reduced',
item ==  'b_empiricalTRUE' ~ 'Empirical abx exposure',
item == 'b_TPNTRUE' ~ 'TPN exposure',
item ==  'b_ENTRUE' ~ 'EN exposure'
)) %>%
mutate(family = str_replace(family, '._Incertae_Sedis',''))
ggplot(post_bi_res, aes(x = family, y = item_name)) +
geom_tile(aes(fill = color,  x = family, y =  item_name), alpha = 0.5, color='white', width=0.95, height=0.95) +
geom_text(aes(label = mark, x = family,y =  item_name),
nudge_y = -0.1, nudge_x = 0,size = 5) +
scale_fill_manual(values = col_key, labels = c('Less than 75% CI crosses 0','75% CI < 0 negative','75% CI > 0 positive')) +
theme_light() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=50, hjust=1, size=11),
axis.text.y=element_text(size=11),
axis.title=element_text(size=axis_title_size),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
legend.position = 'top',
legend.key = element_rect( colour = "gray50"),
panel.background = element_blank())
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 8, height = 5)
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 10, height = 3)
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 10, height = 4)
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 10, height = 4)
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 9, height = 4)
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 10, height = 5)
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 11, height = 6)
ggsave('../figs/paper/054_heatmap_binaries_family_24_ggplot.pdf', width = 9, height = 4)
dcoords <- read_csv('../softwares/phylo-umap/taxumap/results/embedding_for_angel.csv')
View(dcoords)
alpha_val <- 0.05
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'darkgoldenrod2', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'darkgoldenrod2', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'darkgoldenrod2') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
library(tidyverse)
library(ggpubr)
library(cowplot)
library(ggimage)
#library(grConvert)
axis_text_size <- 10
axis_title_size <- 10
alpha_val <- 0.05
point_size <- 1.2
loess_line_col <- 'gray'
scatter_col <- 'gray14'
pick_point_size <- 1
pick_line_size <- 0.5
example_pt_line_size <- 0.3
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'darkgoldenrod2', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'darkgoldenrod2', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'darkgoldenrod2') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
# picked patient
pick <- read_csv('../figs/paper/data/patient_pick_d0_diet.csv')
pick_stool <- meta %>%
filter(mrn == pick$mrn)
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'darkgoldenrod2', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'darkgoldenrod2', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'darkgoldenrod2') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
stool_alpha
day_calori <- dtb %>%
group_by(mrn, fdrt) %>%
summarise(daycal = sum(Calories_kcal))
pick_cal <- day_calori %>%
filter(mrn == pick$mrn[1])
day_cal <- day_calori %>%
ggscatter(x = 'fdrt', y = 'daycal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Daily caloric intake',
title = 'Daily caloric intake',
color = scatter_col,
add = "loess", conf.int = TRUE,
add.params = list(color = loess_line_col, fill = "darkblue", size = 1)) +
geom_point(data = pick_cal, aes(x = fdrt, y = daycal), col = loess_line_col, size = example_pt_line_size) +
geom_line(data = pick_cal, aes(x = fdrt, y = daycal), linetype = 'solid', size = example_pt_line_size, col = loess_line_col) +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
day_cal
# this faith pd is recently calculated in 2021-07
faith <- read_tsv('../data/cleaned_diet_data/FINAL_97_faith_pd/alpha-diversity.tsv') %>%
separate(...1, into = c('mrn', 'fdrt'), sep = 'd', convert = T)  %>%
mutate(mrn = as.numeric(str_replace(mrn, 'P','')))
pick_faith <- faith %>%
filter(mrn == pick$mrn[1])
diet_alpha <- faith %>%
ggscatter('fdrt', 'faith_pd',
alpha = alpha_val,size = point_size,
color = scatter_col,
ylab = "Diet \u03b1 diversity",
xlab = 'Day relative to HCT',
title = 'Diet \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = loess_line_col, fill = "darkblue", size = 1)) +
geom_point(data = pick_faith, aes(x = fdrt, y = faith_pd), col = loess_line_col, size = example_pt_line_size) +
geom_line(data = pick_faith, aes(x = fdrt, y = faith_pd), linetype = 'solid', size = example_pt_line_size, col = loess_line_col) +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
#plot.title = element_text(size=11, hjust = 0.5,  face = 'bold')
) +
theme(aspect.ratio=1)
diet_alpha
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
diet_line_color <- 'darkolivegreen4'
day_calori <- dtb %>%
group_by(mrn, fdrt) %>%
summarise(daycal = sum(Calories_kcal))
pick_cal <- day_calori %>%
filter(mrn == pick$mrn[1])
day_cal <- day_calori %>%
ggscatter(x = 'fdrt', y = 'daycal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Daily caloric intake',
title = 'Daily caloric intake',
color = scatter_col,
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "darkblue", size = 1)) +
geom_point(data = pick_cal, aes(x = fdrt, y = daycal), col = diet_line_color, size = example_pt_line_size) +
geom_line(data = pick_cal, aes(x = fdrt, y = daycal), linetype = 'solid', size = example_pt_line_size, col = diet_line_color) +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
day_cal
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
diet_line_color <- 'darkolivegreen2'
day_calori <- dtb %>%
group_by(mrn, fdrt) %>%
summarise(daycal = sum(Calories_kcal))
pick_cal <- day_calori %>%
filter(mrn == pick$mrn[1])
day_cal <- day_calori %>%
ggscatter(x = 'fdrt', y = 'daycal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Daily caloric intake',
title = 'Daily caloric intake',
color = scatter_col,
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "darkblue", size = 1)) +
geom_point(data = pick_cal, aes(x = fdrt, y = daycal), col = diet_line_color, size = example_pt_line_size) +
geom_line(data = pick_cal, aes(x = fdrt, y = daycal), linetype = 'solid', size = example_pt_line_size, col = diet_line_color) +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
day_cal
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
# this faith pd is recently calculated in 2021-07
faith <- read_tsv('../data/cleaned_diet_data/FINAL_97_faith_pd/alpha-diversity.tsv') %>%
separate(...1, into = c('mrn', 'fdrt'), sep = 'd', convert = T)  %>%
mutate(mrn = as.numeric(str_replace(mrn, 'P','')))
pick_faith <- faith %>%
filter(mrn == pick$mrn[1])
diet_alpha <- faith %>%
ggscatter('fdrt', 'faith_pd',
alpha = alpha_val,size = point_size,
color = scatter_col,
ylab = "Diet \u03b1 diversity",
xlab = 'Day relative to HCT',
title = 'Diet \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "darkblue", size = 1)) +
geom_point(data = pick_faith, aes(x = fdrt, y = faith_pd), col = diet_line_color, size = example_pt_line_size) +
geom_line(data = pick_faith, aes(x = fdrt, y = faith_pd), linetype = 'solid', size = example_pt_line_size, col = diet_line_color) +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
#plot.title = element_text(size=11, hjust = 0.5,  face = 'bold')
) +
theme(aspect.ratio=1)
diet_alpha
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'gold2', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'gold2', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'gold2') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
stool_alpha
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'goldenrod4', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'goldenrod4', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'goldenrod4') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
stool_alpha
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'khaki1', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'khaki1', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'khaki1') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'khaki3', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'khaki3', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'khaki3') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
stool_alpha <- meta %>%
ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, size = point_size,
xlab = 'Day relative to HCT', shape = 'triangle',
ylab = 'Microbiome \u03b1 diversity',
title = 'Microbiome \u03b1 diversity',
add = "loess", conf.int = TRUE,
add.params = list(color = 'khaki2', fill = "darkblue", size = 1)) +
geom_point(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), col = 'khaki2', size = example_pt_line_size, shape = 'triangle') +
geom_line(data = pick_stool, aes(x = sdrt, y = simpson_reciprocal), linetype = 'solid', size = example_pt_line_size, col = 'khaki2') +
theme(axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
bot <- plot_grid(day_cal, diet_alpha, stool_alpha,
nrow = 1,
align = 'hv',
#rel_widths =  c(1,1),
#rel_heights = c(1,1),
labels = c('C','D','E'),
axis = 'tblr')
bot
ggsave('../figs/paper/072_bot_fig1.tiff',
width = 180,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff', plot = bot)
