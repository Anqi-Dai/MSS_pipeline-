p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.5)
diagram
# import the diagram I made
library(cowplot)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.5)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 2, labels = c('A','B'),  align = 'hvlr')
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.5)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 2, labels = c('A','B'),  align = 'hvlr')
fig4
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 2, labels = c('A','B'),  align = 'hvlr')
fig4
diagram
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr')
fig4
fig4 %>% ggsave(
'../figs/paper/F4_124.pdf', width = 170, height = 60, units = c("mm"),
dpi = 400, device = 'pdf'
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr')
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 170, height = 60, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr')
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 170, height = 100, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 2, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,2))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 170, height = 100, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 2, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 170, height = 100, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 2, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 100, height = 100, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 100, height = 100, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 100, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 85, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 90, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# make a nicer version of the fig4 with the day 7 only data
d7 <- alldat4 %>%
filter(abx_treatment == "biapenem") %>%
filter(day_factor_simple == "6-7") %>%
mutate(diet_treatment = str_replace(diet_treatment, '_',' ')) %>%
ggboxplot(x = 'diet_treatment', y = 'Log_CFUs_per_GramStool', add = 'jitter',
xlab = '', ylab = 'CFUs/gram of stool, Log10 Scale',
add.params = list(size = 3, color = 'forestgreen', alpha = 0.5, shape = 16),
title = '') +
scale_y_log10(breaks = c(1 %o% 10^(-1:12)),
labels = trans_format("log10", math_format(10^.x))) +
stat_compare_means(comparisons= list(c('fruit smoothie', 'diet vehicle')),
label= "p.format",
method= 'wilcox.test',
correct=FALSE) +
theme(axis.text =  element_text(size = 10),
axis.title  =  element_text(size = 10))
d7
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_heights = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
ggsave(
'../figs/paper/F4_124.jpg', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'jpg', plot = fig4
)
knitr::opts_chunk$set(echo = TRUE)
library(scales)
library(tidyverse)
exp_title <- 'Experiments 10, 12, 13, 14'
alldat4 <- readRDS("../data/alldat4.rds")
gg4 <- alldat4 %>%
ggplot(aes(day_factor_simple, y=as.numeric(Log_CFUs_per_GramStool))) +
geom_boxplot(aes(fill = diet_treatment), alpha = 0.7,  outlier.shape = NA) +
geom_jitter(width = 0.1, alpha = 0.4, shape = 16, size = 2) +
# geom_dotplot(dotsize=3, binaxis='y', stackdir='center', position=position_dodge(0.5), binwidth = 0.05) +
ylab("CFUs/gram of stool, Log10 Scale") +
scale_y_log10(breaks = c(1 %o% 10^(-1:12)),
labels = trans_format("log10", math_format(10^.x))) +
facet_grid(. ~abx_treatment + diet_treatment)+
ggtitle(exp_title) +
theme(axis.text.x = element_text(angle = 90, vjust =0.5, hjust = 0.5)) +
theme_classic() +
# geom_text_repel(data=alldat1, aes(Day,as.numeric(Log_CFUs_per_GramStool), label=Mouse_identifier), fontface='bold')+
theme(legend.position = "none")
alldat4$Mouse_identifier %>% unique() %>% length()
# wilxocon = 0.0012 for day 6-7
# N = 36 mice across 4 independent experiments
gg4
# ggsave("biapenem_combo.pdf", plot = gg4, device = "pdf")
#Just for targeted stats purposes of day 6-7 with stat_compare_means()
alldat4 %>%
filter(abx_treatment == "biapenem") %>%
filter(day_factor_simple == "6-7") %>%
ggplot(aes(diet_treatment, y=as.numeric(Log_CFUs_per_GramStool))) +
geom_boxplot(alpha = 0.7,  outlier.shape = NA) +
geom_jitter(width = 0.1, alpha = 0.4) +
# geom_dotplot(dotsize=3, binaxis='y', stackdir='center', position=position_dodge(0.5), binwidth = 0.05) +
ylab("CFUs/gram of stool, Log10 Scale") +
scale_y_log10(breaks = c(1 %o% 10^(-1:12)),
labels = trans_format("log10", math_format(10^.x))) +
ggtitle('day 7 only') +
theme(axis.text.x = element_text(angle = 90, vjust =0.5, hjust = 0.5)) +
theme_classic() +
# geom_text_repel(data=alldat1, aes(Day,as.numeric(Log_CFUs_per_GramStool), label=Mouse_identifier), fontface='bold')+
theme(legend.position = "none") +
ggpubr::stat_compare_means()
library(ggpubr)
# the fold change for d0 d7
# of only the biapenem group
dat07 <- alldat4 %>%
filter(abx_treatment == 'biapenem') %>%
select(Experiment, diet_treatment, abx_treatment, Group, Mouse_identifier,Log_CFUs_per_GramStool,day_factor_simple )%>%
filter(day_factor_simple != '3') %>%
spread('day_factor_simple', 'Log_CFUs_per_GramStool') %>%
rename(d0 = `0`, d7 = `6-7`) %>%
mutate(d70_foldchange = d7/d0)
dat07 %>%
ggboxplot(x = 'diet_treatment', y = 'd70_foldchange', add = 'jitter',
title = 'd7 VS d0 fold change') +
scale_y_log10(breaks = c(1 %o% 10^(-1:12)),
labels = trans_format("log10", math_format(10^.x))) +
stat_compare_means()
# make a nicer version of the fig4 with the day 7 only data
d7 <- alldat4 %>%
filter(abx_treatment == "biapenem") %>%
filter(day_factor_simple == "6-7") %>%
mutate(diet_treatment = str_replace(diet_treatment, '_',' ')) %>%
ggboxplot(x = 'diet_treatment', y = 'Log_CFUs_per_GramStool', add = 'jitter',
xlab = '', ylab = 'CFUs/gram of stool, Log10 Scale',
add.params = list(size = 3, color = 'black', alpha = 0.5, shape = 16),
title = '') +
scale_y_log10(breaks = c(1 %o% 10^(-1:12)),
labels = trans_format("log10", math_format(10^.x))) +
stat_compare_means(comparisons= list(c('fruit smoothie', 'diet vehicle')),
label= "p.format",
method= 'wilcox.test',
correct=FALSE) +
theme(axis.text =  element_text(size = 10),
axis.title  =  element_text(size = 10))
d7
# import the diagram I made
library(cowplot)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_width = c(2,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
ggsave(
'../figs/paper/F4_124.jpg', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'jpg', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hvlr', rel_width = c(2,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
ggsave(
'../figs/paper/F4_124.jpg', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'jpg', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hv', rel_width = c(2,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
fig4
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hv', rel_width = c(3,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hv', rel_width = c(1,2))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
# import the diagram I made
library(cowplot)
p <- '../figs/paper/fig4_diagram.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
fig4 <-  plot_grid(diagram,d7,
nrow = 1, labels = c('A','B'),  align = 'hv', rel_width = c(1,1))
fig4
ggsave(
'../figs/paper/F4_124.pdf', width = 150, height = 80, units = c("mm"),
dpi = 400, device = 'pdf', plot = fig4
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv')
library(vdbR)
connect_database()
get_table_from_database('shotgun_lookup_ad')
View(shotgun_lookup_ad)
View(shotgun)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv')
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad)
View(shotgun)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad) %>%
select(fid, projectid)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad) %>%
select(fid, projectid) %>%
arrange(fid, projectid)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad) %>%
select(fid, projectid) %>%
arrange(fid, projectid)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad) %>%
select(fid, projectid) %>%
arrange(projectid)
View(shotgun_lookup_ad)
View(shotgun)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad)
shotgun
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad) %>%
select(fid, projectid, directory) %>%
arrange(projectid)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad) %>%
select(fid, projectid, directory) %>%
arrange(projectid) %>%
mutate(folder = str_extract(directory, 'Sample_.+$'))
View(shotgun)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad)
shotgun <- read_csv('../data/final_comprehensive_UPDATED_simple.csv') %>%
inner_join(shotgun_lookup_ad) %>%
select(fid, projectid, directory) %>%
arrange(projectid) %>%
mutate(folder = str_extract(directory, 'Sample_.+$'))
shotgun %>%
select(folder) %>%
write_csv('../data/16_shotgun_cart_sample.csv', col_names = F)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv')
View(entero)
dtb <- read_csv('../data/cleaned_diet_data/FINAL_97_with_code_all_foods_drt.csv') %>%
select(mrn,fdrt, Meal, Food_NSC, Por_eaten:Sodium_g, Food_code:description, dehydrated_weight )
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv')
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn)
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type)
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type) %>%
filter(nut_type == 'TPN')
entero %>%
count(mrn)
read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type) %>%
filter(nut_type == 'EN') %>%
count(mrn)
read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type) %>%
count(mrn)
read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type) %>%
filter(nut_type == 'TPN') %>%
count(mrn)
read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type) %>%
filter(nut_type == 'EN') %>%
count(mrn)
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type)
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type) %>%
count(mrn)
View(entero)
entero
entero <- read_csv('../data/cleaned_diet_data/TPN_EN patients.csv') %>%
filter(mrn %in% dtb$mrn) %>%
rename(fdrt = Days.Post.HSCT) %>%
mutate(nut_type = if_else(TPN.1..EN.2 == 1, "TPN", "EN")) %>%
select(mrn, fdrt, nut_type) %>%
count(mrn)
summary(entero$n)
