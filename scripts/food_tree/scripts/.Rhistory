theme(axis.text=element_text(size=8),
legend.position = 'none',
axis.text.y = element_blank(),
axis.title=element_text(size=8),
aspect.ratio=1)
two_diff_plot <-  two_diff %>%
filter(term %in% c('fg_fruit','fg_sweets', 'fg_veggie')) %>%
gather('grp', 'post_diff', diff_max_ave:diff_min_ave)
two_diff %>%
filter(term %in% c('fg_fruit','fg_sweets', 'fg_veggie')) %>%
gather('grp', 'post_diff', diff_max_ave:diff_min_ave)
# median of the sweets red line
two_diff %>%
filter(term %in% c('fg_fruit','fg_sweets', 'fg_veggie')) %>%
gather('grp', 'post_diff', diff_max_ave:diff_min_ave) %>%
filter(grp == 'diff_max_ave')
# median of the sweets red line
two_diff %>%
filter(term %in% c('fg_sweets')) %>%
gather('grp', 'post_diff', diff_max_ave:diff_min_ave) %>%
filter(grp == 'diff_max_ave')
# median of the sweets red line
two_diff %>%
filter(term %in% c('fg_sweets')) %>%
gather('grp', 'post_diff', diff_max_ave:diff_min_ave) %>%
filter(grp == 'diff_max_ave') %>%
median(post_diff)
# median of the sweets red line
two_diff %>%
filter(term %in% c('fg_sweets')) %>%
gather('grp', 'post_diff', diff_max_ave:diff_min_ave) %>%
filter(grp == 'diff_max_ave') %>%
summarise(med_sweets = median(post_diff))
# median of the sweets red line
two_diff %>%
filter(term %in% c('fg_sweets')) %>%
gather('grp', 'post_diff', diff_max_ave:diff_min_ave) %>%
filter(grp == 'diff_max_ave') %>%
summarise(ave_sweets = mean(post_diff))
View(max_each_fg_post)
View(dtb)
knitr::opts_chunk$set(echo = TRUE)
engy <- read_excel('../data/source/2015-2016 FNDDS At A Glance - FNDDS Nutrient Values.xlsx', skip = 1, col_types  = 'text')
library(tidyverse)
library(readxl)
library(lubridate)
engy <- read_excel('../data/source/2015-2016 FNDDS At A Glance - FNDDS Nutrient Values.xlsx', skip = 1, col_types  = 'text')
View(engy)
View(dtb)
View(engy)
knitr::opts_chunk$set(echo = TRUE)
library(vdbR)
connect_database('~/dbConfig.txt')
get_table_from_database('shotgun_lookup_ad')
View(shotgun_lookup_ad)
View(shotgun_lookup_ad)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(vdbR)
connect_database()
get_table_from_database('asv_alpha_diversity_ag')
get_table_from_database('shotgun_lookup_ad')
dat <- asv_alpha_diversity_ag %>%
distinct(oligos_id) %>%
mutate(poolid = str_extract(oligos_id, 'pool.+$')) %>%
distinct(poolid) %>%
filter(str_detect(poolid, 'pool835|pool935|pool940|pool1042|pool1048|pool1050|pool1064|pool1109|pool1117|pool1121'))
#pool1109
# total: 2678
duke <- read_csv('../data/duke_samples_for_angel_02-22-2022 (1).csv') %>%
rename(oligos_id = oligoid)
# already 1769
already <- duke %>%
inner_join(asv_alpha_diversity_ag, by = 'oligos_id') %>%
distinct(oligos_id, .keep_all = T)
already %>%
select(oligos_id, path_pool ) %>%
write_csv('../data/duke/already_1769_path.csv')
# missing
missing <- duke %>%
filter(!oligos_id %in% asv_alpha_diversity_ag$oligos_id)
find <- missing %>%
filter(submitted_for_sequencing == 'yes') %>%
select(sampleid, sampleid_clean, oligos_id, notes , experiment)  %>%
mutate(sid = str_replace_all(oligos_id, '-|/|_','\\.'))
find %>%
count(notes)
two <- asv_alpha_diversity_ag %>%
filter(str_detect(path_pool, 'pool1096\\+1097|pool1100')) %>%
select(sampleid, path_pool) %>%
distinct(sampleid, .keep_all = T) %>%
rename(sid = sampleid)
length(intersect(two$sid, find$sid))
setdiff(two$sid, find$sid)
two %>%
write_csv('../data/duke/two_pools_90_path.csv')
setdiff( find$sid, two$sid)
# the 228 that don't know what the pool or where the samples are
where <- find %>%
filter(!sid %in% two$sid)
where %>%
write_csv('../data/duke/where_the_228.csv')
# reply from John
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T) %>%
distinct(js_comment)
length(intersect(reply$sid, asv_alpha_diversity_ag$sampleid))
# total: 2678
duke <- read_csv('../data/duke_samples_for_angel_02-22-2022 (1).csv') %>%
rename(oligos_id = oligoid)
# already 1769
already <- duke %>%
inner_join(asv_alpha_diversity_ag, by = 'oligos_id') %>%
distinct(oligos_id, .keep_all = T)
View(already)
View(where)
View(reply)
View(asv_alpha_diversity_ag)
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T)
# reply from John
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T) %>%
distinct(js_comment)
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T)
library(vdbR)
connect_database()
get_table_from_database('asv_alpha_diversity_ag')
#pool1109
asv_alpha_diversity_ag %>%
write_csv('../data/asv_alpha_diversity_ag.csv')
View(asv_alpha_diversity_ag)
View(already)
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T)
View(reply)
# reply from John
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T) %>%
distinct(js_comment)
View(two)
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T)
View(reply)
View(reply)
View(asv_alpha_diversity_ag)
two
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{/lila/data/brinkvd/daia1/samples/amplicon/Sample_pool1096+1097complete/isolated_oligos}/{sid}_R1.fastq.gz'),
R2 = str_glue('{/lila/data/brinkvd/daia1/samples/amplicon/Sample_pool1096+1097complete/isolated_oligos}/{sid}_R2.fastq.gz'))
)
two
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz'))
)
View(current)
already[1,]
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
1769+90
1769+90
reply
# after running the last pool 11037
reply %>%
filter(str_detect(js_comment, ''11037))
# after running the last pool 11037
reply %>%
filter(str_detect(js_comment, '11037'))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(vdbR)
connect_database()
get_table_from_database('asv_alpha_diversity_ag')
get_table_from_database('shotgun_lookup_ad')
dat <- asv_alpha_diversity_ag %>%
distinct(oligos_id) %>%
mutate(poolid = str_extract(oligos_id, 'pool.+$')) %>%
distinct(poolid) %>%
filter(str_detect(poolid, 'pool835|pool935|pool940|pool1042|pool1048|pool1050|pool1064|pool1109|pool1117|pool1121'))
#pool1109
asv_alpha_diversity_ag %>%
write_csv('../data/asv_alpha_diversity_ag.csv')
# total: 2678
duke <- read_csv('../data/duke_samples_for_angel_02-22-2022 (1).csv') %>%
rename(oligos_id = oligoid)
# already 1769
already <- duke %>%
inner_join(asv_alpha_diversity_ag, by = 'oligos_id') %>%
distinct(oligos_id, .keep_all = T)
already %>%
select(oligos_id, path_pool ) %>%
write_csv('../data/duke/already_1769_path.csv')
# missing
missing <- duke %>%
filter(!oligos_id %in% asv_alpha_diversity_ag$oligos_id)
find <- missing %>%
filter(submitted_for_sequencing == 'yes') %>%
select(sampleid, sampleid_clean, oligos_id, notes , experiment)  %>%
mutate(sid = str_replace_all(oligos_id, '-|/|_','\\.'))
find %>%
count(notes)
two <- asv_alpha_diversity_ag %>%
filter(str_detect(path_pool, 'pool1096\\+1097|pool1100')) %>%
select(sampleid, path_pool) %>%
distinct(sampleid, .keep_all = T) %>%
rename(sid = sampleid)
length(intersect(two$sid, find$sid))
setdiff(two$sid, find$sid)
two %>%
write_csv('../data/duke/two_pools_90_path.csv')
setdiff( find$sid, two$sid)
# the 228 that don't know what the pool or where the samples are
where <- find %>%
filter(!sid %in% two$sid)
where %>%
write_csv('../data/duke/where_the_228.csv')
# reply from John
reply <- read_csv('~/Downloads/where_the_228_JS_03-21-2022.csv') %>%
distinct(sid, .keep_all = T) %>%
distinct(js_comment)
length(intersect(reply$sid, asv_alpha_diversity_ag$sampleid))
# after running the last pool 11037
reply %>%
filter(str_detect(js_comment, '11037'))
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
already[1,]
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
View(current)
current
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
View(current)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
blamks <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(str_detect(oligos_id, '^blank'))
View(blamks)
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
blamks <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(str_detect(oligos_id, '^blank'))
View(blamks)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
View(current)
current %>%
split(str_detect(.$oligos_id, '^blank'))
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{sid}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{sid}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
View(current)
View(asv_alpha_diversity_ag)
two <- asv_alpha_diversity_ag %>%
filter(str_detect(path_pool, 'pool1096\\+1097|pool1100')) %>%
select(sampleid, path_pool) %>%
distinct(sampleid, .keep_all = T) %>%
rename(oligos_id = sampleid)
two %>%
write_csv('../data/duke/two_pools_90_path.csv')
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
current %>%
select(R1, R2) %>%
gather()
current %>%
select(R1, R2)
current %>%
select(R1, R2) %>%
gather()
current %>%
select(R1, R2) %>%
gather() %>%
mutate(cmd = str_glue('cp {value} /home/daia1/my_workdir/samples/amplicon/duke')) %>%
select(cmd)
current %>%
select(R1, R2) %>%
gather() %>%
mutate(cmd = str_glue('cp {value} /home/daia1/my_workdir/samples/amplicon/duke')) %>%
select(cmd) %>%
write_csv('../data/cp_duek_1851.csv'. col_names = F)
current %>%
select(R1, R2) %>%
gather() %>%
mutate(cmd = str_glue('cp {value} /home/daia1/my_workdir/samples/amplicon/duke')) %>%
select(cmd) %>%
write_csv('../data/cp_duek_1851.csv',col_names = F)
current %>%
select(R1, R2) %>%
gather() %>%
mutate(cmd = str_glue('cp {value} /home/daia1/my_workdir/samples/amplicon/duke')) %>%
select(cmd) %>%
write_csv('../data/cp_duek_1851.sh',col_names = F)
View(already)
View(two)
two <- asv_alpha_diversity_ag %>%
filter(str_detect(path_pool, 'pool1096\\+1097|pool1100'))
two <- asv_alpha_diversity_ag %>%
filter(str_detect(path_pool, 'pool1096\\+1097|pool1100')) %>%
select(oligos_id, path_pool) %>%
distinct(oligos_id, .keep_all = T)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
current %>%
select(R1, R2) %>%
gather() %>%
mutate(cmd = str_glue('cp {value} /home/daia1/my_workdir/samples/amplicon/duke')) %>%
select(cmd) %>%
write_csv('../data/cp_duek_1851.sh',col_names = F)
current %>%
select(R1, R2) %>%
gather() %>%
mutate(cmd = str_glue('cp {value} /home/daia1/my_workdir/samples/amplicon/duke')) %>%
select(cmd) %>%
write_csv('../data/cp_duke_1851.sh',col_names = F)
# assemble the file path that need to be copied to the duke folder in amplicon
current <- bind_rows(
two %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz')),
already %>%
mutate(R1 = str_glue('{path_pool}/{oligos_id}_R1.fastq.gz'),
R2 = str_glue('{path_pool}/{oligos_id}_R2.fastq.gz'))
) %>%
filter(!str_detect(oligos_id, '^blank'))
current %>%
select(R1, R2) %>%
gather() %>%
mutate(cmd = str_glue('cp {value} /home/daia1/my_workdir/samples/amplicon/duke')) %>%
select(cmd) %>%
write_csv('../data/cp_duke_1851.sh',col_names = F)
