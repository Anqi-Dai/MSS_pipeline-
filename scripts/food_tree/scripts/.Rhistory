theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=45, vjust=0.9,hjust = 0.9, size=axis_text_size),
axis.text.y=element_text(size=axis_text_size, hjust=0.95,vjust=0.2),
axis.title=element_text(size=axis_title_size),
#legend.position = 'none',
legend.text=element_text(size=8),
legend.key = element_rect( colour = "gray50"))
genus_fg_extra %>% write_rds('../data/120_F2E_extra_genera.rds')
ggsave('../data/120_F2E_extra_genera.pdf', width =  80,plot = genus_fg_extra,
height = 70,
units = c("mm"),
dpi = 400)
div_post_ridge <- post_coeff %>%
left_join(percs) %>%
mutate(shortname = factor(shortname, levels = fg_order)) %>%
ggplot(aes(x = coeff, y = shortname, fill = after_stat(x > 0))) +
stat_pointinterval(.width = c( .95, .95), size = 0.1) + stat_halfeye() +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
geom_text(data = percs, aes(x = pos_x, y = shortname, label = positive, color = after_stat(x > 0))) +
geom_text(data = percs, aes(x = neg_x, y = shortname, label = negative, color =after_stat(x > 0))) +
#scale_fill_manual(values = c("gray80", "skyblue")) +
labs(x = 'ln(diversity) change per 100g of food',
y = '',
title = 'Diversity') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c( "#00BFC4", "#F8766D")) +
scale_fill_manual(values = c( "#00BFC4", "#F8766D")) +
theme(axis.text=element_text(size=axis_text_size, color  = 'black'),
axis.title=element_text(size=axis_text_size),
aspect.ratio=1)
div_post_ridge
div_post_ridge %>%
write_rds('../data/068_div_post_ridge.rds')
div_post_ridge
div_post_ridge <- post_coeff %>%
left_join(percs) %>%
mutate(shortname = factor(shortname, levels = fg_order)) %>%
ggplot(aes(x = coeff, y = shortname, fill = after_stat(x > 0))) +
stat_pointinterval(.width = c( .95, .95), size = 0.1) + stat_halfeye() +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
geom_text(data = percs, aes(x = pos_x, y = shortname, label = positive, color = after_stat(x > 0))) +
geom_text(data = percs, aes(x = neg_x, y = shortname, label = negative, color =after_stat(x > 0))) +
#scale_fill_manual(values = c("gray80", "skyblue")) +
labs(x = 'ln(diversity) change per 100g of food',
y = '',
title = 'Diversity') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c( "#00BFC4", "#F8766D")) +
scale_fill_manual(values = c( "#00BFC4", "#F8766D")) +
theme(axis.text=element_text(size=axis_text_size, color  = 'black'),
axis.title=element_text(size=axis_text_size),
aspect.ratio=1)
div_post_ridge
div_post_ridge %>%
write_rds('../data/068_div_post_ridge.rds')
div_post_ridge <- post_coeff %>%
left_join(percs) %>%
mutate(shortname = factor(shortname, levels = fg_order)) %>%
ggplot(aes(x = coeff, y = shortname, fill = after_stat(x > 0))) +
stat_pointinterval(.width = c( .95, .95), size = 0.1) + stat_halfeye() +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
geom_text(data = percs, aes(x = pos_x, y = shortname, label = positive, color = after_stat(x > 0))) +
geom_text(data = percs, aes(x = neg_x, y = shortname, label = negative, color =after_stat(x > 0))) +
#scale_fill_manual(values = c("gray80", "skyblue")) +
labs(x = 'ln(diversity) change per 100g of food',
y = '',
title = 'Diversity') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c( "#00BFC4", "#F8766D")) +
scale_fill_manual(values = c( "#00BFC4", "#F8766D")) +
theme(axis.text=element_text(size=axis_text_size, color  = 'black'),
axis.title=element_text(size=axis_text_size),
aspect.ratio=1)
div_post_ridge
div_post_ridge %>%
write_rds('../data/068_div_post_ridge.rds')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(cowplot)
axis_text_size <- 10
axis_title_size <- 10
key <- read_csv('../data/cleaned_diet_data/food_group_color_key_final.csv', col_types = 'ccccc')
axis_text_size <- 10
axis_title_size <- 10
key <- read_csv('../data/cleaned_diet_data/food_group_color_key_final.csv', col_types = 'ccccc')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(cowplot)
procrustes_Nday_score <- read_csv('../data/022_procrustes_Nday_score.csv')
macro_pro <- read_csv('../data/091_macro_procrustes_Nday_score.csv')
two_score <- bind_rows(
procrustes_Nday_score %>% mutate(grp = 'Food group based'),
macro_pro %>% mutate(grp = 'Macronutrient based')
)
f2a <- two_score %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
arrange(desc(grp)) %>%
ggplot(aes(x = pNd, y = score, group = grp, color = grp)) +
geom_line(size = 0.3) +
geom_point(size = 1.3) +
labs(x = 'Number of previous days\nof dietary intake',y = 'Procrustes score') +
scale_color_manual(values = c('black','gray60')) +
theme_classic()  +
theme(aspect.ratio=1,
legend.position = 'none',
axis.text=element_text(size=axis_text_size),
legend.title  = element_blank(),
axis.title=element_text(size=axis_text_size),
axis.text.x = element_text(angle=0, hjust=0.5))
f2a
p <- '../figs/paper/cartoon_of_model.png'
diagram <- ggdraw() +
draw_image(magick::image_read(p),   scale = 0.9)
diagram
f2c <- read_rds('../data/068_div_post_ridge.rds')
#f2e <- read_rds('../data/087_entero_genus_fg_main.rds')
f2e <- read_rds('../data/120_F2E_extra_genera.rds')
f2e
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1, 2) )
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1, 2) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 250,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
f2a <- two_score %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
arrange(desc(grp)) %>%
ggplot(aes(x = pNd, y = score, group = grp, color = grp)) +
geom_line(size = 0.3) +
geom_point(size = 1.3) +
labs(x = 'Number of previous days\nof dietary intake',y = 'Procrustes score') +
scale_color_manual(values = c('black','gray60')) +
theme_classic()  +
theme(aspect.ratio=1,
#legend.position = 'none',
axis.text=element_text(size=axis_text_size),
legend.title  = element_blank(),
axis.title=element_text(size=axis_text_size),
axis.text.x = element_text(angle=0, hjust=0.5))
f2a
f2a <- two_score %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
arrange(desc(grp)) %>%
ggplot(aes(x = pNd, y = score, group = grp, color = grp)) +
geom_line(size = 0.3) +
geom_point(size = 1.3) +
labs(x = 'Number of previous days\nof dietary intake',y = 'Procrustes score') +
scale_color_manual(values = c('black','gray60')) +
theme_classic()  +
theme(aspect.ratio=1,
#legend.position = 'none',
axis.text=element_text(size=axis_text_size),
legend.title  = element_blank(),
axis.title=element_text(size=axis_text_size),
axis.text.x = element_text(angle=0, hjust=0.5))
f2a
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1, 2) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 250,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1, 1) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 250,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1, 1) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 220,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
ggsave('../data/F2_model_results_086_new.pdf',
width = 200,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
ggsave('../data/F2_model_results_086_new.pdf',
width = 220,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1.5, 1) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 220,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1.5, 1) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1.5, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 220,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1.5, 1) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 220,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
# new version that is without the diversity prediction thing
left <- cowplot::align_plots(f2a, f2c, align = 'v', axis = 'l')
top <- plot_grid(left[[1]], diagram, labels = c('A', 'B'),rel_widths  = c(1.2, 1) )
bottom <- plot_grid(  left[[2]],f2e,
nrow = 1, labels = c('C','D'), rel_widths  = c(1, 1), align = 'hv')
f2 <-  plot_grid(top,bottom,
rel_heights = c(1,1),
nrow = 2)
f2
ggsave('../data/F2_model_results_086_new.pdf',
width = 220,
height = 170,
#height = 60,
units = c("mm"),
dpi = 400, plot = f2)
knitr::opts_chunk$set(echo = TRUE)
post_samples  <- read_csv('../data/087_Enterococcus_model_fg_post.csv')
nodes <- read_tsv('../data/source/NodeLabels_withcomma.txt', col_types = 'cc') %>%
filter(nchar(Level.code) == 1) %>%
rename(fgrp1 = Level.code,
fdesc = Main.food.description)
key <- read_csv('../data/cleaned_diet_data/food_group_color_key_final.csv', col_types = 'ccccc')
post_coeff <- post_samples %>%
select(starts_with('b_fg')) %>%
gather('item', 'coeff') %>%
mutate(item = str_replace(item, 'b_fg_','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key) %>%
mutate(fdesc = str_replace_all(fdesc, '_',' ')) %>%
mutate(fdesc = str_wrap(fdesc, width = 28, indent = 2, exdent = 0)) %>%
mutate(fdesc = str_replace(fdesc, 'and','&')) %>%
left_join(key %>% select(fgrp1, color, shortname))  %>%
mutate(shortname = fct_reorder(shortname, coeff, .fun=median, .desc = F))  %>%
mutate(shortname = factor(shortname, levels = c("Fruits"  , "Sweets"  ,  "Vegetables", "Grains"    , "Milk"   ,    "Meats"    ,   "Eggs"      , "Legumes" ,   "Oils" )))
# find the 66 and 95 CI
post_coeff %>%
group_by(item) %>%
tidybayes::median_qi(coeff, .width = c( .66, .95))
post_coeff %>%
group_by(item) %>%
summarise(ave = mean(coeff))
coeff_bi <- post_samples %>%
select(starts_with('b_')) %>%
select(!starts_with('b_fg')) %>%
gather('item', 'coeff') %>%
mutate(item_name = case_when(
item ==  'b_intensitynonablative' ~ 'Intensity: nonablative',
item == 'b_intensityablative' ~ 'Intensity: ablative',
item ==  'b_intensityreduced' ~ 'Intensity: reduced',
item ==  'b_empiricalTRUE' ~ 'Empirical abx exposure',
item == 'b_TPNTRUE' ~ 'TPN exposure',
item ==  'b_ENTRUE' ~ 'EN exposure'
)) %>%
mutate(item_name = factor(item_name, levels = c('Intensity: nonablative', 'Intensity: reduced',
'Intensity: ablative', 'TPN exposure','EN exposure',
'Empirical abx exposure'))) %>%
mutate(grp = if_else(str_detect(item_name, 'Intensity'), 'Patient level', 'Sample level'))
entero_genus_factor <- coeff_bi %>%
ggplot(aes(x = coeff, y = item_name)) +
tidybayes::stat_pointinterval(.width = c(.66, .95)) +
#scale_color_manual(values = c('#EC0000','#00468B')) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
facet_wrap(grp~ . , scales = 'free', dir = 'v') +
labs(x = 'Coefficients',
y = 'Factor variables',
title = 'Enterococcus') +
theme_classic() +
theme(legend.position = 'none',
strip.background = element_blank(),
strip.text = element_blank(),
aspect.ratio=1/2)
entero_genus_factor %>% write_rds('../data/087_entero_genus_factor_forest.rds')
div_fac <- read_rds('../data/068_diversity_factor_forest.rds')
enter_fac <- read_rds('../data/087_entero_genus_factor_forest.rds')
fac2 <- plot_grid(  div_fac,enter_fac,
nrow = 1, labels = c('A','B'), rel_widths = c(1, 1))
ggsave('../figs/paper/S5_div_entero_factor_086.pdf',
width = 170,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'pdf', plot = fac2)
div_fac <- read_rds('../data/068_diversity_factor_forest.rds')
enter_fac <- read_rds('../data/087_entero_genus_factor_forest.rds')
fac2 <- plot_grid(  div_fac,enter_fac,
nrow = 1, labels = c('A','B'), rel_widths = c(1, 1))
ggsave('../data/S5_div_entero_factor_086.pdf',
width = 170,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'pdf', plot = fac2)
enter_fac <- read_rds('../data/087_entero_genus_factor_forest.rds')
enter_fac <- read_rds('../data/087_entero_genus_factor_forest.rds')
div_fac <- read_rds('../data/068_diversity_factor_forest.rds')
div_fac <- read_rds('../data/068_diversity_factor_forest.rds')
enter_fac <- read_rds('../data/087_entero_genus_factor_forest.rds')
fac2 <- plot_grid(  div_fac,enter_fac,
nrow = 1, labels = c('A','B'), rel_widths = c(1, 1))
ggsave('../data/S5_div_entero_factor_086.pdf',
width = 170,
height = 60,
#height = 60,
units = c("mm"),
dpi = 400, device = 'pdf', plot = fac2)
post_df <- read_csv('../data/087_genus_foodgroup_model_post.csv', col_select = c(1:10))
post_extra <- read_csv('../data/087_genus_foodgroup_model_post_extra_few.csv', col_select = c(1:10))
View(post_df)
View(post_extra)
length(intersect(post_df$genus, post_extra$genus))
intersect(post_df$genus, post_extra$genus)
unique(post_extra$genus)
post_res_genera <- post_df %>%
select(genus, starts_with('b_fg')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
count(coeff > 0)
View(post_res_genera)
# post_extra <- read_csv('../data/087_genus_foodgroup_model_post_extra_few.csv', col_select = c(1:10))
# length(intersect(post_df$genus, post_extra$genus))
# unique(post_extra$genus)
# post_all <- bind_rows(post_df, post_extra)
fg_order <- read_csv('../data/068_fg_sorting_order.csv') %>% pull(shortname)
# post_extra <- read_csv('../data/087_genus_foodgroup_model_post_extra_few.csv', col_select = c(1:10))
# length(intersect(post_df$genus, post_extra$genus))
# unique(post_extra$genus)
# post_all <- bind_rows(post_df, post_extra)
fg_order <- read_csv('../data/068_fg_sorting_order.csv') %>% pull(shortname)
post_res_genera <- post_df %>%
select(genus, starts_with('b_fg')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
count(coeff > 0) %>%
mutate(perc = round(n/4000*100, 2)) %>%
filter(`coeff > 0` == 'TRUE') %>%
mutate(item = str_replace(item, 'b_','')) %>%
left_join(key %>% select(item = fg1_name, shortname), by = "item") %>%
mutate(shortname = factor(shortname, levels = fg_order))
genus_fg_main <- ggplot(post_res_genera, aes(x = genus, y = shortname)) +
geom_tile(aes(fill = perc,  x = genus, y =  shortname), alpha = 0.5, color='white', width=0.95, height=0.95) +
theme_pubr() +
scale_fill_gradient(low = "white", high = "#F8766D") +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=50, hjust=1, size=10),
axis.text.y=element_text(size=10),
axis.title=element_text(size=axis_title_size),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
legend.position = 'top',
panel.background=element_rect(colour="black"),
legend.key = element_rect( colour = "gray50"))
genus_fg_main
post_bi_res <- post_df %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
count(coeff > 0) %>%
mutate(perc = round(n/4000*100, 2)) %>%
filter(`coeff > 0` == 'TRUE')
View(post_bi_res)
# the factors for the genus-fg
post_df <- read_csv('../data/087_genus_foodgroup_model_post.csv', col_select = c(1, 14:16))
post_bi_res <- post_df %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
count(coeff > 0) %>%
mutate(perc = round(n/4000*100, 2)) %>%
filter(`coeff > 0` == 'TRUE')
post_bi_res <- post_df %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
count(coeff > 0) %>%
mutate(perc = round(n/4000*100, 2)) %>%
filter(`coeff > 0` == 'TRUE')
post_bi_res <- post_df %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
count(coeff > 0) %>%
mutate(perc = round(n/4000*100, 2)) %>%
filter(`coeff > 0` == 'TRUE') %>%
mutate(item_name = case_when(
item ==  'b_empiricalTRUE' ~ 'Empirical abx exposure',
item == 'b_TPNTRUE' ~ 'TPN exposure',
item ==  'b_ENTRUE' ~ 'EN exposure'
))
# the factors for the genus-fg
post_df <- read_csv('../data/087_genus_foodgroup_model_post.csv', col_select = c(1, 14:16))
# post_extra <- read_csv('../data/087_genus_foodgroup_model_post_extra_few.csv', col_select = c(1, 14:16))
#
# post_all <- bind_rows(post_df, post_extra)
post_bi_res <- post_df %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
count(coeff > 0) %>%
mutate(perc = round(n/4000*100, 2)) %>%
filter(`coeff > 0` == 'TRUE') %>%
mutate(item_name = case_when(
item ==  'b_empiricalTRUE' ~ 'Empirical abx exposure',
item == 'b_TPNTRUE' ~ 'TPN exposure',
item ==  'b_ENTRUE' ~ 'EN exposure'
))
genus_fg_factor <- ggplot(post_bi_res, aes(x = genus, y = item_name)) +
geom_tile(aes(fill = perc,  x = genus, y =  item_name), alpha = 0.5, color='white', width=0.95, height=0.95) +
scale_fill_gradient(low = "white", high = "#F8766D") +
theme_pubr() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle=50, hjust=1, size=11),
axis.text.y=element_text(size=11),
axis.title=element_text(size=axis_title_size),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
legend.position = 'top',
legend.key = element_rect( colour = "gray50"),
panel.background = element_rect(colour="black"))
genus_fg_factor
# stack the two heatmap together
library(cowplot)
heatmap <-  plot_grid(  genus_fg_main,genus_fg_factor,
nrow = 2, labels = c('A','B'), rel_heights  = c(1, 0.6), align = 'hv', axis = 'tblr')
ggsave( '../data/S8_heatmap_fg_genus_087.pdf',
width = 270,
height = 220,
#height = 60,
units = c("mm"),
dpi = 400, device = 'pdf', plot = heatmap)
