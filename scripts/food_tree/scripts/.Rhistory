mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white')))
post_res_genera %>% distinct(item)
post_df <- read_csv('../data/171_genus_foodgroup_model_post_extra_few_interaction.csv',  col_select = c(1:25))
colnames(post_df)
colnames(post_df)
post_df <- read_csv('../data/171_genus_foodgroup_model_post_extra_few_interaction.csv',  col_select = c(1:25)) %>%
select(genus, starts_with('b_fg'))
# make the heatmap with all of the genera
post_df <- read_csv('../data/171_genus_foodgroup_model_post_extra_few_interaction.csv',  col_select = c(1:25)) %>%
select(genus, starts_with('b_fg'))
post_res_genera <- post_df %>%
select(genus, starts_with('b_fg')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key %>% select(fgrp1, color, shortname)) %>%
mutate(shortname = case_when(
item ==  'milk_e' ~ 'abx + Milk',
item == 'meat_e' ~ 'abx + Meats',
item ==  'egg_e' ~ 'abx + Eggs',
item ==  'legume_e' ~ 'abx + Legumes',
item == 'grain_e' ~ 'abx + Grains',
item == 'fruit_e' ~ 'abx + Fruits',
item == 'veggie_e' ~ 'abx + Vegetables',
item ==  'oils_e' ~ 'abx + Oils',
item ==  'sweets_e' ~ 'abx + Sweets',
item ==  'nonablative' ~ 'Nonablative',
item ==  'reduced' ~ 'Reduced',
item ==  'ablative' ~ 'Ablative',
item ==  'TPN' ~ 'TPN',
item ==  'EN' ~ 'EN',
item ==  'abx' ~ 'abx',
TRUE ~ `shortname`
)) %>%
mutate(grp = if_else(item %in% c('nonablative','reduced','ablative'), 'patient', 'temporal'))
post_res_genera %>% distinct(item)
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key %>% select(fgrp1, color, shortname)) %>%
mutate(shortname = case_when(
item ==  'milk_e' ~ 'abx + Milk',
item == 'meat_e' ~ 'abx + Meats',
item ==  'egg_e' ~ 'abx + Eggs',
item ==  'legume_e' ~ 'abx + Legumes',
item == 'grain_e' ~ 'abx + Grains',
item == 'fruit_e' ~ 'abx + Fruits',
item == 'veggie_e' ~ 'abx + Vegetables',
item ==  'oils_e' ~ 'abx + Oils',
item ==  'sweets_e' ~ 'abx + Sweets',
item ==  'nonablative' ~ 'Nonablative',
item ==  'reduced' ~ 'Reduced',
item ==  'ablative' ~ 'Ablative',
item ==  'TPN' ~ 'TPN',
item ==  'EN' ~ 'EN',
item ==  'abx' ~ 'abx',
TRUE ~ `shortname`
)) %>%
mutate(grp = if_else(item %in% c('nonablative','reduced','ablative'), 'patient', 'temporal'))
post_res_genera %>% distinct(item)
# make the heatmap with all of the genera
post_df <- read_csv('../data/171_genus_foodgroup_model_post_extra_few_interaction.csv',  col_select = c(1:25)) %>%
select(genus, starts_with('b_'))
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key %>% select(fgrp1, color, shortname)) %>%
mutate(shortname = case_when(
item ==  'milk_e' ~ 'abx + Milk',
item == 'meat_e' ~ 'abx + Meats',
item ==  'egg_e' ~ 'abx + Eggs',
item ==  'legume_e' ~ 'abx + Legumes',
item == 'grain_e' ~ 'abx + Grains',
item == 'fruit_e' ~ 'abx + Fruits',
item == 'veggie_e' ~ 'abx + Vegetables',
item ==  'oils_e' ~ 'abx + Oils',
item ==  'sweets_e' ~ 'abx + Sweets',
item ==  'nonablative' ~ 'Nonablative',
item ==  'reduced' ~ 'Reduced',
item ==  'ablative' ~ 'Ablative',
item ==  'TPN' ~ 'TPN',
item ==  'EN' ~ 'EN',
item ==  'abx' ~ 'abx',
TRUE ~ `shortname`
)) %>%
mutate(grp = if_else(item %in% c('nonablative','reduced','ablative'), 'patient', 'temporal'))
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key %>% select(fgrp1, color, shortname)) %>%
mutate(shortname = case_when(
item ==  'milk_e' ~ 'abx + Milk',
item == 'meat_e' ~ 'abx + Meats',
item ==  'egg_e' ~ 'abx + Eggs',
item ==  'legume_e' ~ 'abx + Legumes',
item == 'grain_e' ~ 'abx + Grains',
item == 'fruit_e' ~ 'abx + Fruits',
item == 'veggie_e' ~ 'abx + Vegetables',
item ==  'oils_e' ~ 'abx + Oils',
item ==  'sweets_e' ~ 'abx + Sweets',
item ==  'nonablative' ~ 'Nonablative',
item ==  'reduced' ~ 'Reduced',
item ==  'ablative' ~ 'Ablative',
item ==  'TPN' ~ 'TPN',
item ==  'EN' ~ 'EN',
item ==  'abx' ~ 'abx',
TRUE ~ `shortname`
)) %>%
mutate(grp = if_else(item %in% c('nonablative','reduced','ablative'), 'patient', 'temporal'))
post_res_genera %>% distinct(item)
post_res_genera %>% distinct(shortname)
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity',''))
post_res_genera %>% distinct(item)
post_res_genera %>% distinct(item)
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))
post_res_genera %>% distinct(fgrp1)
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key %>% select(fgrp1, color, shortname)) %>%
mutate(shortname = case_when(
item ==  'milk_e' ~ 'abx + Milk',
item == 'meat_e' ~ 'abx + Meats',
item ==  'egg_e' ~ 'abx + Eggs',
item ==  'legume_e' ~ 'abx + Legumes',
item == 'grain_e' ~ 'abx + Grains',
item == 'fruit_e' ~ 'abx + Fruits',
item == 'veggie_e' ~ 'abx + Vegetables',
item ==  'oils_e' ~ 'abx + Oils',
item ==  'sweets_e' ~ 'abx + Sweets',
item ==  'nonablative' ~ 'Nonablative',
item ==  'reduced' ~ 'Reduced',
item ==  'ablative' ~ 'Ablative',
item ==  'TPN' ~ 'TPN',
item ==  'EN' ~ 'EN',
item ==  'abx' ~ 'abx',
TRUE ~ `shortname`
)) %>%
mutate(grp = if_else(item %in% c('nonablative','reduced','ablative'), 'patient', 'temporal'))
key <- read_csv('../data/cleaned_diet_data/food_group_color_key_final.csv', col_types = 'ccccc')
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key %>% select(fgrp1, color, shortname))
post_res_genera %>% distinct(shortname)
key %>% select(fgrp1, color, shortname
)
post_df <- read_csv('../data/171_genus_foodgroup_model_post_extra_few_interaction.csv',  col_select = c(1:25)) %>%
select(genus, starts_with('b_'))
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity',''))
post_res_genera %>% distinct(item)
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(fgrp1 = case_when(
item ==  'milk' ~ '1',
item == 'meat' ~ '2',
item ==  'egg' ~ '3',
item ==  'legume' ~ '4',
item == 'grain' ~ '5',
item == 'fruit' ~ '6',
item == 'veggie' ~ '7',
item ==  'oils' ~ '8',
item ==  'sweets' ~ '9'
))  %>%
left_join(key %>% select(fgrp1, color, shortname))
post_res_genera %>% distinct(shortname)
key %>% select(fgrp1, color, shortname)
key %>% select(fgrp1, color, shortname)
key %>% select(fgrp1, color, shortname)
# make the heatmap with all of the genera
post_df <- read_csv('../data/171_genus_foodgroup_model_post_extra_few_interaction.csv',  col_select = c(1:25)) %>%
select(genus, starts_with('b_'))
key <- read_csv('../data/cleaned_diet_data/food_group_color_key_final.csv', col_types = 'ccccc')
post_res_genera <- post_df %>%
select(genus, starts_with('b_')) %>%
gather('item','coeff', names(.)[2]:names(.)[ncol(.)]) %>%
group_by(genus, item) %>%
summarise(q50 = median(coeff),
q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975),
q12.5 = quantile(coeff, probs = 0.125),
q87.5 = quantile(coeff, probs = 0.875),
q1.25 = quantile(coeff, probs = 0.0125),
q98.75 = quantile(coeff, probs = 0.9875),
q0.5 = quantile(coeff, probs = 0.005),
q99.5 = quantile(coeff, probs = 0.995)
) %>%
ungroup() %>%
mutate(mark = if_else(q99.5 < 0 | q0.5 > 0, '***', if_else(q98.75 < 0 | q1.25 > 0, '**', if_else(q97.5 < 0 | q2.5 > 0, '*', '')))) %>%
mutate(color = if_else(q87.5 < 0, 'steelblue', if_else(q12.5 > 0, 'maroon', 'white'))) %>%
mutate(item = str_replace(item, 'b_fg_',''),
item = str_replace(item, 'b_',''),
item = str_replace(item, 'intensity','')) %>%
mutate(shortname = case_when(
item ==  'milk' ~ 'Milk',
item == 'meat' ~ 'Meats',
item ==  'egg' ~ 'Eggs',
item ==  'legume' ~ 'Legumes',
item == 'grain' ~ 'Grains',
item == 'fruit' ~ 'Fruits',
item == 'veggie' ~ 'Vegetables',
item ==  'oils' ~ 'Oils',
item ==  'sweets' ~ 'Sweets',
item ==  'milk_e' ~ 'abx + Milk',
item == 'meat_e' ~ 'abx + Meats',
item ==  'egg_e' ~ 'abx + Eggs',
item ==  'legume_e' ~ 'abx + Legumes',
item == 'grain_e' ~ 'abx + Grains',
item == 'fruit_e' ~ 'abx + Fruits',
item == 'veggie_e' ~ 'abx + Vegetables',
item ==  'oils_e' ~ 'abx + Oils',
item ==  'sweets_e' ~ 'abx + Sweets',
item ==  'nonablative' ~ 'Nonablative',
item ==  'reduced' ~ 'Reduced',
item ==  'ablative' ~ 'Ablative',
item ==  'TPN' ~ 'TPN',
item ==  'EN' ~ 'EN',
item ==  'abx' ~ 'abx'
)) %>%
mutate(grp = if_else(item %in% c('nonablative','reduced','ablative'), 'patient', 'temporal'))
post_res_genera %>% distinct(shortname)
post_res_genera %>% write_csv('../data/171_post_res_genera.csv')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggtree)
install.packages('ggtree')
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ggtree")
library(ggtree)
beast_file <- system.file("examples/MCC_FluA_H3.tree", package="ggtree")
beast_tree <- read.beast(beast_file)
library(TDbook)
install.packages("TDbook")
install.packages("TDbook")
library(TDbook)
beast_file <- system.file("examples/MCC_FluA_H3.tree", package="ggtree")
beast_tree <- read.beast(beast_file)
library(ggimage)
beast_file <- system.file("examples/MCC_FluA_H3.tree", package="ggtree")
beast_tree <- read.beast(beast_file)
install.packages('ips')
library(ggimage)
beast_file <- system.file("examples/MCC_FluA_H3.tree", package="ggtree")
beast_tree <- read.beast(beast_file)
library(ips)
beast_file <- system.file("examples/MCC_FluA_H3.tree", package="ggtree")
beast_tree <- read.beast(beast_file)
sessionInfo()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggtree)
library(TDbook)
library(ggimage)
library(ips)
beast_file <- system.file("examples/MCC_FluA_H3.tree", package="ggtree")
beast_tree <- read.beast(beast_file)
beast_file <- system.file("examples/MCC_FluA_H3.tree", package="ggtree")
beast_tree <- read.beast(beast_file)
