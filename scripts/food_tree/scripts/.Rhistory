filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = macro_order$shortname)) %>%
left_join(cross0_macro)  %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
geom_rect(data=macro_rect, mapping=aes(xmin=xmin_, xmax=xmax_, ymin=ymin_, ymax=ymax_, fill='blue')) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
labs(x = '', y = '') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c("#EC0000", "black")) +
theme(axis.text.y = element_text( size = 10),
axis.title=element_text(size=10), panel.background = element_rect(fill = "#d8dcec",colour = "#d8dcec",size = 0.5, linetype = "solid"),
aspect.ratio=1/1.5)
macro_temporal
cleaned_macro %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = macro_order$shortname)) %>%
left_join(cross0_macro)  %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95))
cleaned_macro %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = macro_order$shortname)) %>%
left_join(cross0_macro)  %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
geom_rect(data=macro_rect, mapping=aes(xmin=xmin_, xmax=xmax_, ymin=ymin_, ymax=ymax_, fill='blue'))
macro_temporal <- cleaned_macro %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = macro_order$shortname)) %>%
left_join(cross0_macro)  %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
geom_rect(data=macro_rect, mapping=aes(xmin=1, xmax=2, ymin=3, ymax=4, fill='blue')) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
labs(x = '', y = '') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c("#EC0000", "black")) +
theme(axis.text.y = element_text( size = 10),
axis.title=element_text(size=10), panel.background = element_rect(fill = "#d8dcec",colour = "#d8dcec",size = 0.5, linetype = "solid"),
aspect.ratio=1/1.5)
macro_temporal
macro_temporal <- cleaned_macro %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = macro_order$shortname)) %>%
left_join(cross0_macro)  %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
#geom_rect(data=macro_rect, mapping=aes(xmin=1, xmax=2, ymin=3, ymax=4, fill='blue')) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
labs(x = '', y = '') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c("#EC0000", "black")) +
theme(axis.text.y = element_text( size = 10),
axis.title=element_text(size=10), panel.background = element_rect(fill = "#d8dcec",colour = "#d8dcec",size = 0.5, linetype = "solid"),
aspect.ratio=1/1.5)
macro_temporal
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
macro_pt <- cleaned_macro %>%
filter(grp == 'patient') %>%
mutate(shortname = factor(shortname, levels = c('Nonablative','Reduced','Ablative'))) %>%
ggplot(aes(x = coeff, y = shortname)) +
stat_pointinterval(.width = c(.66, .95)) +
labs(x = 'ln(diversity) change', y = '') +
xlim(1.5, 2.5) +
theme_classic() +
theme(legend.position = 'none') +
theme(axis.text = element_text( size = 10),
panel.background = element_rect(fill = "#d0cccc",colour = "#d0cccc",size = 0.5, linetype = "solid"),
axis.title=element_text(size=10),
aspect.ratio=1/2.5)
macro_side <-  plot_grid(macro_temporal,macro_pt,
rel_heights = c(1.5,1),align = 'hv',axis = 'lrtb',
nrow = 2)
macro_side
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
ggsave('../data/F2_model_results_176.pdf',
width = 150, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
cross0 <- cleaned_fg %>%
filter(grp == 'temporal') %>%
group_by(item) %>%
summarise(q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975)) %>%
mutate(Cross = if_else(q2.5 >= 0 | q97.5 <= 0, F, T))
fg_temporal <- cleaned_fg %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = fg_label$ord)) %>%
left_join(cross0) %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
#geom_rect( data = cleaned_fg, aes(xmin = -Inf  , xmax = Inf,  ymin = shortname, ymax = shortname), fill = "grey", alpha = 0.8) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
labs(x = '', y = '') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c("#EC0000", "black")) +
theme(axis.text = element_text( size = 10),panel.background = element_rect(fill = "#d8dcec",colour = "#d8dcec",size = 0.5, linetype = "solid"),
axis.title=element_text(size=10),
aspect.ratio=1)
fg_temporal
# the fg  patient
fg_pt <- cleaned_fg %>%
filter(grp == 'patient') %>%
mutate(shortname = factor(shortname, levels = c('Nonablative','Reduced','Ablative'))) %>%
ggplot(aes(x = coeff, y = shortname)) +
stat_pointinterval(.width = c(.66, .95)) +
labs(x = 'ln(diversity) change', y = '') +
xlim(0.9, 3) +
theme_classic() +
theme(legend.position = 'none') +
theme(axis.text = element_text( size = 10),
panel.background = element_rect(fill = "#d0cccc",colour = "#d0cccc",size = 0.5, linetype = "solid"),axis.title=element_text(size=10),
aspect.ratio=1/4.5)
# assemble the ones for the fg
fg_side <-  plot_grid(fg_temporal,fg_pt,
rel_heights = c(3,1),align = 'vh',axis = 'lrtb',
nrow = 2)
fg_side
cross0 <- cleaned_fg %>%
filter(grp == 'temporal') %>%
group_by(item) %>%
summarise(q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975)) %>%
mutate(Cross = if_else(q2.5 >= 0 | q97.5 <= 0, F, T))
fg_temporal <- cleaned_fg %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = fg_label$ord)) %>%
left_join(cross0) %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
#geom_rect( data = cleaned_fg, aes(xmin = -Inf  , xmax = Inf,  ymin = shortname, ymax = shortname), fill = "grey", alpha = 0.8) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
labs(x = '', y = '') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c("#EC0000", "black")) +
theme(axis.text = element_text( size = 10),panel.background = element_rect(fill = "#d8dcec",colour = "#d8dcec",size = 0.5, linetype = "solid"),
axis.title=element_text(size=10),
aspect.ratio=1)
fg_temporal
cleaned_fg %>%
filter(grp == 'patient') %>%
mutate(shortname = factor(shortname, levels = c('Nonablative','Reduced','Ablative'))) %>%
ggplot(aes(x = coeff, y = shortname)) +
stat_pointinterval(.width = c(.66, .95)) +
labs(x = 'ln(diversity) change', y = '') +
xlim(0.9, 3) +
theme_classic() +
theme(legend.position = 'none') +
theme(axis.text = element_text( size = 10),
panel.background = element_rect(fill = "#d0cccc",colour = "#d0cccc",size = 0.5, linetype = "solid"),axis.title=element_text(size=10),
aspect.ratio=1/4.5)
fg_side <-  plot_grid(fg_temporal,fg_pt,
rel_heights = c(3,1),align = 'vh',axis = 'lrtb',
nrow = 2)
fg_side
cross0 <- cleaned_fg %>%
filter(grp == 'temporal') %>%
group_by(item) %>%
summarise(q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975)) %>%
mutate(Cross = if_else(q2.5 >= 0 | q97.5 <= 0, F, T))
fg_temporal <- cleaned_fg %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = fg_label$ord)) %>%
left_join(cross0) %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
#geom_rect( data = cleaned_fg, aes(xmin = -Inf  , xmax = Inf,  ymin = shortname, ymax = shortname), fill = "grey", alpha = 0.8) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
labs(x = '', y = '') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c("#EC0000", "black")) +
theme(axis.text = element_text( size = 10),panel.background = element_rect(fill = "#d8dcec",colour = "#d8dcec",size = 0.5, linetype = "solid"),
axis.title=element_text(size=10),
aspect.ratio=1.5)
fg_temporal
cross0 <- cleaned_fg %>%
filter(grp == 'temporal') %>%
group_by(item) %>%
summarise(q2.5 = quantile(coeff, probs = 0.025),
q97.5 = quantile(coeff, probs = 0.975)) %>%
mutate(Cross = if_else(q2.5 >= 0 | q97.5 <= 0, F, T))
fg_temporal <- cleaned_fg %>%
filter(grp == 'temporal') %>%
mutate(shortname = factor(shortname, levels = fg_label$ord)) %>%
left_join(cross0) %>%
ggplot(aes(x = coeff, y = shortname, col = Cross)) +
stat_pointinterval(.width = c(.66, .95)) +
#geom_rect( data = cleaned_fg, aes(xmin = -Inf  , xmax = Inf,  ymin = shortname, ymax = shortname), fill = "grey", alpha = 0.8) +
geom_vline(xintercept = 0, col = 'black', linetype = 'dashed') +
labs(x = '', y = '') +
theme_classic() +
theme(legend.position = 'none') +
scale_color_manual(values = c("#EC0000", "black")) +
theme(axis.text = element_text( size = 10),panel.background = element_rect(fill = "#d8dcec",colour = "#d8dcec",size = 0.5, linetype = "solid"),
axis.title=element_text(size=10),
aspect.ratio=1.5)
fg_temporal
# the fg  patient
fg_pt <- cleaned_fg %>%
filter(grp == 'patient') %>%
mutate(shortname = factor(shortname, levels = c('Nonablative','Reduced','Ablative'))) %>%
ggplot(aes(x = coeff, y = shortname)) +
stat_pointinterval(.width = c(.66, .95)) +
labs(x = 'ln(diversity) change', y = '') +
xlim(0.9, 3) +
theme_classic() +
theme(legend.position = 'none') +
theme(axis.text = element_text( size = 10),
panel.background = element_rect(fill = "#d0cccc",colour = "#d0cccc",size = 0.5, linetype = "solid"),axis.title=element_text(size=10),
aspect.ratio=1/3)
# assemble the ones for the fg
fg_side <-  plot_grid(fg_temporal,fg_pt,
rel_heights = c(3,1),align = 'vh',axis = 'lrtb',
nrow = 2)
fg_side
# the fg  patient
fg_pt <- cleaned_fg %>%
filter(grp == 'patient') %>%
mutate(shortname = factor(shortname, levels = c('Nonablative','Reduced','Ablative'))) %>%
ggplot(aes(x = coeff, y = shortname)) +
stat_pointinterval(.width = c(.66, .95)) +
labs(x = 'ln(diversity) change', y = '') +
xlim(0.9, 3) +
theme_classic() +
theme(legend.position = 'none') +
theme(axis.text = element_text( size = 10),
panel.background = element_rect(fill = "#d0cccc",colour = "#d0cccc",size = 0.5, linetype = "solid"),axis.title=element_text(size=10),
aspect.ratio=1/3.2)
# assemble the ones for the fg
fg_side <-  plot_grid(fg_temporal,fg_pt,
rel_heights = c(3,1),align = 'vh',axis = 'lrtb',
nrow = 2)
fg_side
# the fg  patient
fg_pt <- cleaned_fg %>%
filter(grp == 'patient') %>%
mutate(shortname = factor(shortname, levels = c('Nonablative','Reduced','Ablative'))) %>%
ggplot(aes(x = coeff, y = shortname)) +
stat_pointinterval(.width = c(.66, .95)) +
labs(x = 'ln(diversity) change', y = '') +
xlim(0.9, 3) +
theme_classic() +
theme(legend.position = 'none') +
theme(axis.text = element_text( size = 10),
panel.background = element_rect(fill = "#d0cccc",colour = "#d0cccc",size = 0.5, linetype = "solid"),axis.title=element_text(size=10),
aspect.ratio=1/3.1)
# assemble the ones for the fg
fg_side <-  plot_grid(fg_temporal,fg_pt,
rel_heights = c(3,1),align = 'vh',axis = 'lrtb',
nrow = 2)
fg_side
fg_side
fg_side
fg_side
fg_side
diagram
diagram
diagram
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,4),
nrow = 2)
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,4),
nrow = 2)
#F2 <- plot_grid(left, right, nrow = 1)
ggsave('../data/F2_model_results_176.pdf',
width = 150, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,4),
nrow = 2)
F2 <- plot_grid(left, right, nrow = 1)
ggsave('../data/F2_model_results_176.pdf',
width = 150, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,4),
nrow = 2)
F2 <- plot_grid(left, right, nrow = 1)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,3),
nrow = 2)
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,3),
nrow = 2)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
fg_side
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,3),
nrow = 2)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,4.5),
nrow = 2)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,5),
nrow = 2)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
F2 <- plot_grid(left, right, nrow = 1)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
library(cowplot)
title <- ggdraw() +
draw_label(
"Fig 2",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
plot.margin = margin(0, 0, 0, 7)
)
title
?plot.margin
title <- ggdraw() +
draw_label(
"Fig 2",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
plot.margin = margin(0, 0, 0, 7)
)
f2 <-  plot_grid(left,right,
rel_widths = c(1,1),
nrow = 1)
combined <- plot_grid(
title, f2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,5),
nrow = 2)
f2 <-  plot_grid(left,right,
rel_widths = c(1,1),
nrow = 1)
combined <- plot_grid(
title, f2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
) +theme(plot.margin = unit(c(1,0.5,0.5,0.5), "cm"))
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
combined <- plot_grid(
title, f2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
combined <- plot_grid(
title, f2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
) +theme(plot.margin = unit(c(1,0.5,0.5,0.5), "cm"))
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
combined <- plot_grid(
title, f2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
) +theme(plot.margin = unit(c(1,1,1,1), "cm"))
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
f2a <- twoscore %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
arrange(desc(grp)) %>%
mutate(pNd =  factor(pNd)) %>%
ggplot(aes(x = pNd, y = score, group = grp, linetype = grp)) +
geom_line(size = 0.3) +
geom_point(size = 1.3) +
labs(x = 'Number of previous days\nof dietary intake',y = 'Procrustes score') +
scale_linetype_manual(values = c('solid','dashed')) +
theme_classic()  +
theme(aspect.ratio=1/3,
legend.position = c(0.75,0.4),
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_text_size),
legend.title = element_blank(),
axis.text.x = element_text(angle=0, hjust=0.5))
f2a
twoscore <- read_csv('../data/086_twoscore_procrustes.csv')
f2a <- twoscore %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
arrange(desc(grp)) %>%
mutate(pNd =  factor(pNd)) %>%
ggplot(aes(x = pNd, y = score, group = grp, linetype = grp)) +
geom_line(size = 0.3) +
geom_point(size = 1.3) +
labs(x = 'Number of previous days\nof dietary intake',y = 'Procrustes score') +
scale_linetype_manual(values = c('solid','dashed')) +
theme_classic()  +
theme(aspect.ratio=1/1.5,
legend.position = c(0.75,0.4),
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_text_size),
legend.title = element_blank(),
axis.text.x = element_text(angle=0, hjust=0.5))
f2a
left <- plot_grid(f2a, macro_side,
#labels = c('A', 'B'),
rel_heights = c(1,2.2),
nrow = 2)
right <- plot_grid(diagram, fg_side,
#labels = c('A', 'B'),
rel_heights = c(1,5),
nrow = 2)
f2 <-  plot_grid(left,right,
rel_widths = c(1,1),
nrow = 1)
combined <- plot_grid(
title, f2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
) +theme(plot.margin = unit(c(1,1,1,1), "cm"))
ggsave('../data/F2_model_results_176.pdf',
width = 210, height = 217, units = "mm", device = 'pdf',
#plot = combined,
dpi = 300)
