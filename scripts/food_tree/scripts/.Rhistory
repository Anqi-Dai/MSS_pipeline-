theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=1))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday <- map2_dfc(fns_both$dfn, fns_both$sfn, function(dfn, sfn){
dpcoa = read_tsv(dfn, skip = 9, col_names = F)  %>%
filter(! X1 %in% c('Biplot','Site constraints')) %>%
column_to_rownames('X1') %>%
as.matrix()
spcoa = read_tsv(sfn, skip = 9, col_names = F)  %>%
filter(! X1 %in% c('Biplot','Site constraints')) %>%
column_to_rownames('X1') %>%
as.matrix()
procrustes_res = procrustes(X = dpcoa, Y = spcoa)
return( procrustes_res$ss)
}) %>%
gather(key = 'pNd', value = 'ss') %>%
mutate(pNd = fns_both$ID)
procrustes_Nday %>%
ggboxplot(y =  'ss', add = 'dotplot', label = 'pNd', repel = T,
xlab = '', ylab = 'Sum of squares',
title = 'procrustes ss (all qualified stool samples)')
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake') +
geom_line(aes(x = pNd, y = ss)) +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake') +
geom_line(aes(x = pNd, y = ss)) +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake') +
geom_line(aes(x = pNd, y = ss), group = 1) +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake') +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 3) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed') +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.5) +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
?geom_line
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.1) +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text.x = element_text(angle=0, hjust=0.5))
# make the figure
axis_text_size <- 10
axis_title_size <- 10
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
axis.text.x = element_text(angle=0, hjust=0.5))
ggsave('../figs/paper/fig2_procrustes.tiff',
width = 80,
height = 40,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff')
# make the figure
axis_text_size <- 8
axis_title_size <- 8
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
axis.text.x = element_text(angle=0, hjust=0.5))
ggsave('../figs/paper/fig2_procrustes.tiff',
width = 80,
height = 40,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff')
# make the figure
axis_text_size <- 6
axis_title_size <- 6
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
axis.text.x = element_text(angle=0, hjust=0.5))
ggsave('../figs/paper/fig2_procrustes.tiff',
width = 80,
height = 40,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff')
# make the figure
axis_text_size <- 4
axis_title_size <- 4
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
axis.text.x = element_text(angle=0, hjust=0.5))
ggsave('../figs/paper/fig2_procrustes.tiff',
width = 80,
height = 40,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff')
# make the figure
axis_text_size <- 6
axis_title_size <- 6
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days of dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
axis.text.x = element_text(angle=0, hjust=0.5))
ggsave('../figs/paper/fig2_procrustes.tiff',
width = 80,
height = 40,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff')
# make the figure
axis_text_size <- 6
axis_title_size <- 6
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days\nof dietary intake', size = 2) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
axis.text.x = element_text(angle=0, hjust=0.5))
ggsave('../figs/paper/fig2_procrustes.tiff',
width = 80,
height = 40,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff')
# make the figure
axis_text_size <- 6
axis_title_size <- 6
procrustes_Nday %>%
mutate(pNd = str_extract(pNd, '\\d')) %>%
ggdotchart(x = 'pNd', y = 'ss', sorting = 'none', ylab = 'Sum of squares',
xlab = 'Number of previous days\nof dietary intake', size = 1.3) +
geom_line(aes(x = pNd, y = ss), group = 1, linetype = 'dashed', size = 0.3) +
theme(aspect.ratio=1,
axis.text=element_text(size=axis_text_size),
axis.title=element_text(size=axis_title_size),
axis.text.x = element_text(angle=0, hjust=0.5))
ggsave('../figs/paper/fig2_procrustes.tiff',
width = 80,
height = 40,
#height = 60,
units = c("mm"),
dpi = 400, device = 'tiff')
knitr::opts_chunk$set(echo = TRUE)
library(ggpubr)
library(tidyverse)
# use the example patient's day -5 diet to make a pie chart
pick <- read_csv('../figs/paper/data/patient_pick_d0_diet.csv')
View(pick)
# use the example patient's day -5 diet to make a pie chart
pick <- read_csv('../figs/paper/data/patient_pick_d0_diet.csv')
View(pick)
# use the example patient's day -5 diet to make a pie chart
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv')
View(pick)
# use the example patient's day -5 diet to make a pie chart
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5)
View(pick)
?ggpie
pick
# use the example patient's day -5 diet to make a pie chart
key <- read_csv('../data/cleaned_diet_data/food_group_color_key.csv')
View(key)
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1")
key
# use the example patient's day -5 diet to make a pie chart
key <- read_csv('../data/cleaned_diet_data/food_group_color_key.csv', col_types = 'ccc')
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1")
View(pick)
pick
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, color) %>%
summarise(total = sum(dehydrated_weight))
pick
read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, color)
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight))
pick
pick %>%
#mutate(lbl = factor(lbl, levels = c("AD 1%", "TS 11%", "MXE 0%", "RI 57%", "AF 0%", "CE 13%", "AA 3%", "AL 0%", "TE 14%"))) %>%
ggpie(x = 'fgrp1',
label = 'fg1_name',
color = 'white',
size = 0,
lab.font = c(6,'plain','red'),
fill = pick$color) +
#labs(tag = str_glue('Total number of significant AS events: {total_number}')) +
theme(plot.tag.position = c(0.55, 0))
pick %>%
#mutate(lbl = factor(lbl, levels = c("AD 1%", "TS 11%", "MXE 0%", "RI 57%", "AF 0%", "CE 13%", "AA 3%", "AL 0%", "TE 14%"))) %>%
ggpie(x = 'fgrp1',
label = 'fg1_name',
color = 'white',
size = 0,
lab.font = c(6,'plain','red'),
fill = pick$color)
pick %>%
#mutate(lbl = factor(lbl, levels = c("AD 1%", "TS 11%", "MXE 0%", "RI 57%", "AF 0%", "CE 13%", "AA 3%", "AL 0%", "TE 14%"))) %>%
ggpie(x = 'fg1_name',
#label = 'fg1_name',
color = 'white',
size = 0,
lab.font = c(6,'plain','red'),
fill = pick$color)
pick %>%
#mutate(lbl = factor(lbl, levels = c("AD 1%", "TS 11%", "MXE 0%", "RI 57%", "AF 0%", "CE 13%", "AA 3%", "AL 0%", "TE 14%"))) %>%
ggpie(x = 'total',
#label = 'fg1_name',
color = 'white',
size = 0,
lab.font = c(6,'plain','red'),
fill = pick$color)
# use the example patient's day -5 diet to make a pie chart
key <- read_csv('../data/cleaned_diet_data/food_group_color_key.csv', col_types = 'ccc')
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight))
pick %>%
#mutate(lbl = factor(lbl, levels = c("AD 1%", "TS 11%", "MXE 0%", "RI 57%", "AF 0%", "CE 13%", "AA 3%", "AL 0%", "TE 14%"))) %>%
ggpie(x = 'total',
label = 'fg1_name',
color = 'white',
size = 0,
lab.font = c(6,'plain','red'),
fill = pick$color)
View(pick)
pick
ggpie(pick, "total", label = "fg1_name")
pick
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
mutate(fg1_name = factor(fg1_name))
ggpie(pick, "total", label = "fg1_name")
pick
pick
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = total/sum(total)*100)
ggpie(pick, "perc", label = "fg1_name")
pick
ggpie(pick, "perc", label = "color")
pick
ggpie(pick, "perc", label = "fgrp1")
pick
library(vdbR)
connect_database('~/dbConfig.txt')
get_table_from_database('asv_alpha_diversity_ag')
View(asv_alpha_diversity_ag)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(ggpubr)
library(tidyverse)
# use the example patient's day -5 diet to make a pie chart
key <- read_csv('../data/cleaned_diet_data/food_group_color_key.csv', col_types = 'ccc')
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = total/sum(total)*100)
pick %>%
#mutate(lbl = factor(lbl, levels = c("AD 1%", "TS 11%", "MXE 0%", "RI 57%", "AF 0%", "CE 13%", "AA 3%", "AL 0%", "TE 14%"))) %>%
ggpie(x = 'total',
label = 'fg1_name',
color = 'white',
size = 0,
lab.font = c(6,'plain','red'),
fill = pick$color)
df <- data.frame(
group = c("Male", "Female", "Child"),
value = c(25, 25, 50))
ggpie(df, "value", label = "group")
pick
pick
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = total/sum(total)*100)
pick
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = total/sum(total))
View(pick)
pick
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = (total/sum(total))*100)
read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1")
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
#mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = (total/sum(total))*100)
pick
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
#mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = (total/sum(total)))
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight))
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
#mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = total/sum(total))
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total = sum(dehydrated_weight)) %>%
#mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = total/sum(total))
pick <- read_csv('../figs/paper/data/patient_pick_all_diet.csv') %>%
filter(fdrt == -5) %>%
select( mrn, fdrt, Food_code, description, dehydrated_weight ) %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
left_join(key, by = "fgrp1") %>%
group_by(fgrp1, fg1_name, color) %>%
summarise(total_g = sum(dehydrated_weight)) %>%
#mutate(fg1_name = factor(fg1_name)) %>%
mutate(perc = total_g/sum(total_g))
sum(pick$total_g)
53/452
