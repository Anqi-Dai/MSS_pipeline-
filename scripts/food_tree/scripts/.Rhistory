d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 100)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180,
units = c("mm"),
plot = macro_facets)
Blautia_lim
entero_lim <- floor(min(byday_original$Enterococcus))
Blautia_lim <- floor(min(byday_original$Blautia))
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 100)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180,
units = c("mm"),
plot = macro_facets)
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 100)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 16,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180,
units = c("mm"),
plot = macro_facets)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 100)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 200)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 250)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
macro_panel <- byday_original %>%
mutate(simpson_reciprocal_nlog  = log(simpson_reciprocal)) %>%
rename(`log10(Blautia)` = Blautia,
`log10(Enterococcus)` = Enterococcus,
`log(Simpson reciprocal)` = simpson_reciprocal_nlog) %>%
dplyr::select(`log(Simpson reciprocal)`, `log10(Blautia)`, `log10(Enterococcus)`,  daycal:d_sugar ) %>%
mutate(daycal = daycal/1000) %>%  # now divide the value by 1000 to save some space in x axis text!!!
gather('yaxis', 'value', `log(Simpson reciprocal)`:`log10(Enterococcus)`) %>%
mutate(yaxis = factor(yaxis, levels = c('log(Simpson reciprocal)','log10(Blautia)','log10(Enterococcus)'))) %>%
gather('xaxis', 'number', daycal:d_sugar) %>%
mutate(xaxis = factor(xaxis, levels = c('daycal','d_carb','d_sugar','d_fiber','d_protein','d_fat'))) %>%
mutate(xaxis = if_else(str_detect(xaxis, '^d_'), str_replace(xaxis, 'd_',''), str_replace(xaxis, '^day','')),
xaxis = if_else(str_detect(xaxis, 'cal'), str_replace(xaxis, 'cal','caloric'), xaxis),
xaxis = str_to_title(xaxis),
xaxis = str_glue('{xaxis}')) %>%
mutate(xaxis = factor(xaxis, levels = c('Caloric','Carb','Sugar','Fiber','Protein','Fat')))
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 250)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_panel <- byday_original %>%
mutate(simpson_reciprocal_nlog  = log(simpson_reciprocal)) %>%
rename(`log10(Blautia)` = Blautia,
`log10(Enterococcus)` = Enterococcus,
`log(Simpson reciprocal)` = simpson_reciprocal_nlog) %>%
dplyr::select(`log(Simpson reciprocal)`, `log10(Blautia)`, `log10(Enterococcus)`,  daycal:d_sugar ) %>%
mutate(daycal = daycal/1000) %>%  # now divide the value by 1000 to save some space in x axis text!!!
gather('yaxis', 'value', `log(Simpson reciprocal)`:`log10(Enterococcus)`) %>%
mutate(yaxis = factor(yaxis, levels = c('log(Simpson reciprocal)','log10(Blautia)','log10(Enterococcus)'))) %>%
gather('xaxis', 'number', daycal:d_sugar) %>%
mutate(xaxis = factor(xaxis, levels = c('daycal','d_carb','d_sugar','d_fiber','d_protein','d_fat'))) %>%
mutate(xaxis = if_else(str_detect(xaxis, '^d_'), str_replace(xaxis, 'd_',''), str_replace(xaxis, '^day','')),
xaxis = if_else(str_detect(xaxis, 'cal'), str_replace(xaxis, 'cal','caloric'), xaxis),
xaxis = str_to_title(xaxis),
xaxis = str_glue('{xaxis}')) %>%
mutate(xaxis = factor(xaxis, levels = c('Caloric','Carb','Sugar','Fiber','Protein','Fat')))
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Daily Caloric Intake` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Daily Protein Intake` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Daily Fat Intake` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Daily Carb Intake` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 250)),
`Daily Fiber Intake` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Daily Sugar Intake` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
macro_facets
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Caloric` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Protein` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Fat` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Carb` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 250)),
`Fiber` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Sugar` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
macro_panel <- byday_original %>%
mutate(simpson_reciprocal_nlog  = log(simpson_reciprocal)) %>%
rename(`log10(Blautia)` = Blautia,
`log10(Enterococcus)` = Enterococcus,
`log(Simpson reciprocal)` = simpson_reciprocal_nlog) %>%
dplyr::select(`log(Simpson reciprocal)`, `log10(Blautia)`, `log10(Enterococcus)`,  daycal:d_sugar ) %>%
mutate(daycal = daycal/1000) %>%  # now divide the value by 1000 to save some space in x axis text!!!
gather('yaxis', 'value', `log(Simpson reciprocal)`:`log10(Enterococcus)`) %>%
mutate(yaxis = factor(yaxis, levels = c('log(Simpson reciprocal)','log10(Blautia)','log10(Enterococcus)'))) %>%
gather('xaxis', 'number', daycal:d_sugar) %>%
mutate(xaxis = factor(xaxis, levels = c('daycal','d_carb','d_sugar','d_fiber','d_protein','d_fat'))) %>%
mutate(xaxis = if_else(str_detect(xaxis, '^d_'), str_replace(xaxis, 'd_',''), str_replace(xaxis, '^day','')),
xaxis = if_else(str_detect(xaxis, 'cal'), str_replace(xaxis, 'cal','calorie'), xaxis),
xaxis = str_to_title(xaxis),
xaxis = str_glue('{xaxis}')) %>%
mutate(xaxis = factor(xaxis, levels = c('Caloric','Carb','Sugar','Fiber','Protein','Fat')))
macro_panel <- byday_original %>%
mutate(simpson_reciprocal_nlog  = log(simpson_reciprocal)) %>%
rename(`log10(Blautia)` = Blautia,
`log10(Enterococcus)` = Enterococcus,
`log(Simpson reciprocal)` = simpson_reciprocal_nlog) %>%
dplyr::select(`log(Simpson reciprocal)`, `log10(Blautia)`, `log10(Enterococcus)`,  daycal:d_sugar ) %>%
mutate(daycal = daycal/1000) %>%  # now divide the value by 1000 to save some space in x axis text!!!
gather('yaxis', 'value', `log(Simpson reciprocal)`:`log10(Enterococcus)`) %>%
mutate(yaxis = factor(yaxis, levels = c('log(Simpson reciprocal)','log10(Blautia)','log10(Enterococcus)'))) %>%
gather('xaxis', 'number', daycal:d_sugar) %>%
mutate(xaxis = factor(xaxis, levels = c('daycal','d_carb','d_sugar','d_fiber','d_protein','d_fat'))) %>%
mutate(xaxis = if_else(str_detect(xaxis, '^d_'), str_replace(xaxis, 'd_',''), str_replace(xaxis, '^day','')),
xaxis = if_else(str_detect(xaxis, 'cal'), str_replace(xaxis, 'cal','calorie'), xaxis),
xaxis = str_to_title(xaxis),
xaxis = str_glue('{xaxis}')) %>%
mutate(xaxis = factor(xaxis, levels = c('Calorie','Carb','Sugar','Fiber','Protein','Fat')))
library(facetscales)
Blautia_lim <- floor(min(byday_original$Blautia))
entero_lim <- floor(min(byday_original$Enterococcus))
simpson_reciprocal_nlog_lim <- max(log(byday_original$simpson_reciprocal))
scales_y <- list(
`log(Simpson reciprocal)` = scale_y_continuous(limits = c(0, simpson_reciprocal_nlog_lim), breaks = seq(0, simpson_reciprocal_nlog_lim, 1)),
`log10(Blautia)` = scale_y_continuous(limits = c(Blautia_lim, 0), breaks = seq(Blautia_lim, 0, 2)),
`log10(Enterococcus)` = scale_y_continuous(limits = c(entero_lim, 0), breaks = seq(entero_lim, 0, 2))
)
# to use the max observed in the data
cal_lim <- max(byday_original$daycal)/1000
protein_lim <- max(byday_original$d_protein)
d_fat_lim <- max(byday_original$d_fat)
d_carb_lim <- max(byday_original$d_carb)
d_fiber_lim <- max(byday_original$d_fiber)
d_sugar_lim <- max(byday_original$d_sugar)
scales_x <- list(
`Calorie` = scale_x_continuous(limits = c(0, cal_lim), breaks = seq(0, cal_lim, 1)),
`Protein` = scale_x_continuous(limits = c(0, protein_lim), breaks = seq(0, protein_lim, 50)),
`Fat` = scale_x_continuous(limits = c(0, d_fat_lim), breaks = seq(0, d_fat_lim, 50)),
`Carb` = scale_x_continuous(limits = c(0, d_carb_lim), breaks = seq(0, d_carb_lim, 250)),
`Fiber` = scale_x_continuous(limits = c(0,d_fiber_lim), breaks = seq(0, d_fiber_lim, 20)),
`Sugar` = scale_x_continuous(limits = c(0, d_sugar_lim), breaks = seq(0, d_sugar_lim, 100) )
)
macro_facets <- macro_panel %>%
ggscatter(x = 'number', y = 'value', alpha = 0.05, xlab = '', ylab = '',size = 1.2, pch = 19,
add = "reg.line",  # Add regressin line
add.params = list(color = "darkblue", fill = "gray59"), # Customize line
conf.int = TRUE, # Add confidence interval
) +
facet_grid_sc(rows = vars(yaxis), cols = vars(xaxis), scales = list(y = scales_y, x = scales_x)) +
theme_classic(base_size = 11) +
theme(aspect.ratio = 1,
panel.background = element_rect(fill = "gray97"),
panel.grid.major = element_blank(),
strip.background = element_blank(),
#strip.text = element_blank(),
panel.grid.minor = element_blank()
)
ggsave('../data/150_b2_sameday_macronutrients_microbiome.pdf',
width = 180, height = 150,
units = c("mm"),
plot = macro_facets)
pvals <- macro_panel %>%
split(., list(.$xaxis, .$yaxis)) %>%
map(function(df) {
res = summary(lm(value ~ number, data = df ))
return(pval = round(res$coefficients[2, 'Pr(>|t|)'], 3))
})
pvals
