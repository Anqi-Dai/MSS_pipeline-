distinct(mrn,fdrt, diet_data_status)
View(zerodays1)
# imputing zeros for the zero eating days
zerodays1 <- zero1 %>%
filter(is.na(Meal)) %>%
distinct(mrn,fdrt, diet_data_status) %>%
select(colnames(zerodays2))
zerodaysall <- bind_rows(zerodays1, zerodays2)
View(zerodaysall)
View(zerodaysall)
zerodaysall %>% write_csv('../data/072_total_patients_zero_eating_days.csv')
View(m_all)
# are there any NAs
m_all %>%
gather('key','value', Carbohydrates:Sugars) %>%
filter(is.na(value)) %>% nrow
View(m_all)
m_all <- dtb %>%
select(mrn, fdrt,Protein_g:Sugars_g ) %>%
gather('grp','gram', Protein_g:Sugars_g) %>%
mutate(grp = str_replace(grp, '_g$','')) %>%
group_by(mrn, fdrt, grp) %>%
summarise(eachsum = sum(gram)) %>%
spread('grp', 'eachsum')
View(m_all)
# are there any NAs
m_all %>%
gather('key','value', Carbohydrates:Sugars) %>%
filter(is.na(value)) %>% nrow
View(zerodaysall)
zerodaysall
m_all
dailymacro <- bind_rows(
m_all,
zerodaysall %>%
mutate(Carbohydrates = 0, Fat= 0, Fibers= 0, Protein= 0, Sugars= 0)
)
View(dailymacro)
dailymacro <- bind_rows(
m_all,
zerodaysall %>%
mutate(Carbohydrates = 0, Fat= 0, Fibers= 0, Protein= 0, Sugars= 0) %>%
select(colnames(m_all))
)
dailymacro %>% write_csv('../data/072_all_daily_macronutrients.csv')
View(dailymacro)
dailymacro
View(dailymacro)
dailymacro
dailymacro <- bind_rows(
m_all,
zerodaysall %>%
mutate(Carbohydrates = 0, Fat= 0, Fibers= 0, Protein= 0, Sugars= 0) %>%
select(colnames(m_all))
) %>% gather('grp','eachsum', Carbohydrates:Sugars)
dailymacro <- bind_rows(
m_all,
zerodaysall %>%
mutate(Carbohydrates = 0, Fat= 0, Fibers= 0, Protein= 0, Sugars= 0) %>%
select(colnames(m_all))
) %>% gather('grp','eachsum', Carbohydrates:Sugars)
dailymacro %>% write_csv('../data/072_all_daily_macronutrients.csv')
dailymacro
m_panel <- dailymacro %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp, nrow = 1, scales = 'free_y') +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
m_panel
m_panel <- dailymacro %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp, nrow = 3, scales = 'free_y') +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
m_panel
point_size
point_size
m_panel <- dailymacro %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp, nrow = 3, scales = 'free_y') +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
m_panel
m_panel
fg_all <- dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key)
key
key <- read_csv('../data/cleaned_diet_data/food_group_color_key_final.csv')
fg_all <- dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key)
View(fg_all)
fg_all
key
dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname))
fg_all <- dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname)) %>%
spread('shortname','eachsum')
dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname))
fg_all <- dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname)) %>%
select(-fgrp1) %>%
spread('shortname','eachsum')
dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname)) %>%
select(-fgrp1)
dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname)) %>%
select(-fgrp1)
fg_all <- dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname)) %>%
select(-fgrp1) %>%
spread('shortname','eachsum')
fg_all <- dtb %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
mutate(fgrp1 = as.numeric(fgrp1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(eachsum = sum(dehydrated_weight)) %>%
left_join(key %>% select(fgrp1, shortname)) %>%
select(-fgrp1) %>%
spread('shortname','eachsum', fill = 0)
zerodaysall
fg_all
zerodaysall
zerodaysall
fg_all
zerodaysall
fg_all
fg_total <- bind_rows(
fg_all,
zerodaysall %>%
mutate(Eggs = 0, Fruits= 0, Grains= 0, Legumes= 0, Meats= 0, Milk= 0,Oils= 0,Sweets= 0,Vegetables= 0) %>%
select(colnames(fg_all))
)
View(fg_total)
fg_total
fg_total <- bind_rows(
fg_all,
zerodaysall %>%
mutate(Eggs = 0, Fruits= 0, Grains= 0, Legumes= 0, Meats= 0, Milk= 0,Oils= 0,Sweets= 0,Vegetables= 0) %>%
select(colnames(fg_all))
) %>%  gather('grp','eachsum', Eggs:Vegetables)
fg_total %>% write_csv('../data/072_all_daily_foodgroups.csv')
fg_total <- bind_rows(
fg_all,
zerodaysall %>%
mutate(Eggs = 0, Fruits= 0, Grains= 0, Legumes= 0, Meats= 0, Milk= 0,Oils= 0,Sweets= 0,Vegetables= 0) %>%
select(colnames(fg_all))
) %>%  gather('grp','eachsum', Eggs:Vegetables)
fg_total %>% write_csv('../data/072_all_daily_foodgroups.csv')
fg_total
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ shortname,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ shortname,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ shortname,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
fg_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ shortname,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
fg_total
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
scale_y_sqrt() +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
scale_y_log10() +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
scale_y_sqrt() +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
m_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
#scale_y_sqrt() +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.005, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
scale_y_sqrt() +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
subpanels <- plot_grid( m_panel, fg_panel,
nrow = 1,
align = 'hv',
rel_widths =  c(1.2,1.4),
#rel_heights = c(1,1),
#labels = c('E','F', 'G', "H"),
axis = 'tblr')
ggsave('../data/072_subpanels.pdf',
width = 140,
height = 120,
#height = 60,
units = c("mm"),
dpi = 400, plot = subpanels)
subpanels <- plot_grid( m_panel, fg_panel,
nrow = 1,
align = 'hv',
rel_widths =  c(1,1.5),
#rel_heights = c(1,1),
#labels = c('E','F', 'G', "H"),
axis = 'tblr')
ggsave('../data/072_subpanels.pdf',
width = 140,
height = 120,
#height = 60,
units = c("mm"),
dpi = 400, plot = subpanels)
point_size
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.001, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
scale_y_sqrt() +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
m_panel <- dailymacro %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.001, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp, nrow = 3, scales = 'free_y') +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
m_panel
subpanels <- plot_grid( m_panel, fg_panel,
nrow = 1,
align = 'hv',
rel_widths =  c(1,1.5),
#rel_heights = c(1,1),
#labels = c('E','F', 'G', "H"),
axis = 'tblr')
ggsave('../data/072_subpanels.pdf',
width = 140,
height = 120,
#height = 60,
units = c("mm"),
dpi = 400, plot = subpanels)
fg_panel
fg_panel <- fg_total %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.002, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp,
scales = 'free_y',
nrow = 3, ) +
scale_x_continuous( breaks = seq(0, 50, 20)) +
scale_y_sqrt() +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
fg_panel
m_panel <- dailymacro %>%
ggscatter(x = 'fdrt', y = 'eachsum', alpha = 0.002, size = point_size,
xlab = 'Day relative to HCT',
ylab = 'Grams',
add = "loess", conf.int = TRUE,
add.params = list(color = diet_line_color, fill = "hotpink", size = 1))  +
facet_wrap(~ grp, nrow = 3, scales = 'free_y') +
scale_x_continuous( breaks = seq(0, 50, 20)) +
theme(axis.text=element_text(size=6),
strip.background = element_blank(),
strip.text.x = element_text(size = stip_txt_size),
axis.title=element_text(size=axis_title_size),
plot.title = element_text(size=axis_title_size),
aspect.ratio=1)
m_panel
subpanels <- plot_grid( m_panel, fg_panel,
nrow = 1,
align = 'hv',
rel_widths =  c(1,1.5),
#rel_heights = c(1,1),
#labels = c('E','F', 'G', "H"),
axis = 'tblr')
ggsave('../data/072_subpanels.pdf',
width = 140,
height = 120,
#height = 60,
units = c("mm"),
dpi = 400, plot = subpanels)
