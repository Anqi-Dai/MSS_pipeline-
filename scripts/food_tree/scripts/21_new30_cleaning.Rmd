---
title: "the new 30 cleaning"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggpubr)
library(readxl)
```

```{r}
# the computrition output of the new 30
new <- read_excel('../data/source/new30_all.xlsx') %>% 
  distinct(Food_NSC)

# the ones that we already have food code
uni <- read_excel('../data/source/eaten_FNDDS.xlsx', sheet = 1)

uniq_food <- uni %>% 
  distinct(item1_value_raw_raw,  .keep_all = T)

length(intersect(uniq_food$item1_value_raw_raw, new$Food_NSC))

# the ones that don't have exact match with the food nsc thus don't have a code
unknown <- new %>% 
  filter(! Food_NSC %in% uniq_food$item1_value_raw_raw) %>% 
  arrange(Food_NSC) %>% 
  # remove the title lines (not food)
  filter(!str_detect(Food_NSC, '^\\*\\*\\*\\*\\*\\*\\*'))

unknown %>% 
  write_csv('../data/source/new30_unknown_food_nsc.csv')
```

