---
title: "The fig1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggpubr)
```

# fig1 bottom 3

The first 2 need to be redo, since the data has been updated.

```{r}
dtb <- read_csv('../data/cleaned_diet_data/FINAL_97_with_code_all_foods_drt_with_EN_finalized.csv')
meta <- read_csv('../data/cleaned_stool/all_samples_meta_p2d_fg9_updated.csv')
```
```{r}
alpha_val <- 0.3
```


```{r stool_alpha}
stool_alpha <- meta %>% 
  ggscatter(x = 'sdrt', y = 'simpson_reciprocal', alpha = alpha_val, 
            xlab = 'Day relative to HCT',
            ylab = 'Microbiome alpha diversity',
            add = "loess", color = 'darkgoldenrod3',
            add.params = list(color = "darkgoldenrod4", fill = "darkgray", size = 2), 
            conf.int = TRUE) +
  theme(axis.text=element_text(size=10),
        axis.title=element_text(size=10),
        aspect.ratio=1)
stool_alpha
```

```{r caloric_intake}
day_calori <- dtb %>% 
  group_by(mrn, fdrt) %>% 
  summarise(daycal = sum(Calories_kcal))

day_cal <- day_calori %>% 
  ggscatter(x = 'fdrt', y = 'daycal', alpha = alpha_val, 
            xlab = 'Day relative to HCT',
            ylab = 'Daily caloric intake',
            add = "loess", color = 'maroon',
            add.params = list(color = "brown", fill = "darkgray", size = 2), 
            conf.int = TRUE) +
  theme(axis.text=element_text(size=10),
        axis.title=element_text(size=10),
        aspect.ratio=1)
day_cal
```
