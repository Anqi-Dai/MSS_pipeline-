rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
filter(x20_5_n_3_g > 0 | x22_5_n_3_g > 0 |x22_6_n_3_g > 0 ) %>%
left_join(ptb_all, by = "mrn")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
filter(x20_5_n_3_g > 0 | x22_5_n_3_g > 0 |x22_6_n_3_g > 0 ) %>%
left_join(ptb_all, by = "mrn")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
filter(x20_5_n_3_g > 0 | x22_5_n_3_g > 0 |x22_6_n_3_g > 0 ) %>%
left_join(ptb_all, by = "mrn")
dailyoil
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g)
View(dailytotaloil)
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g)
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g)
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g)
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g)
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g)
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram))
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram))
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram))
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram)) %>%
left_join(ptb_all %>%
select(mrn,d100_a_gvhd))
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram))
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram)) %>%
left_join(ptb_all %>%
select(mrn,d100_a_gvhd))
dailytotaloil
dailytotaloil %>%
filter(  d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'total_fatty', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = '',
add.params = list(color = 'd100_a_gvhd', size = 1))
dailytotaloil %>%
filter(  d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'total_fatty', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = '',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
#facet_grid(~ soluble)  +
#scale_color_manual(values = color_key) +
#scale_fill_manual(values = color_key)+
scale_y_sqrt()
dailyoil %>% write_csv('../data/12_fatty_pt.csv')
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
dailyoil %>% write_csv('../data/12_fatty_pt.csv')
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram)) %>%
left_join(ptb_all %>%
select(mrn,d100_a_gvhd))
dailytotaloil %>%
filter(  d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'total_fatty', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = '',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
#facet_grid(~ soluble)  +
#scale_color_manual(values = color_key) +
#scale_fill_manual(values = color_key)+
scale_y_sqrt()
View(nutrientsdf)
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
filter(x20_5_n_3_g > 0 | x22_5_n_3_g > 0 |x22_6_n_3_g > 0 ) %>%
left_join(ptb_all, by = "mrn")
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram)) %>%
left_join(ptb_all %>%
select(mrn,d100_a_gvhd))
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
dailyoil %>% write_csv('../data/12_fatty_pt.csv')
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram)) %>%
left_join(ptb_all %>%
select(mrn,d100_a_gvhd))
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
dailyoil <- DTB %>%
group_by(mrn, fdrt ,Food_code ) %>%
summarise(dailydrywt = sum(dehydrated_weight),
dailywetwt = sum(total_weight)) %>%
rename(food_code = Food_code) %>%
left_join(nutrientsdf, by = "food_code") %>%
# calculate the weight in the total wet weight using the percentage
mutate(x20_5_n_3_g = dailywetwt * x20_5_n_3_g/100,
x22_5_n_3_g = dailywetwt * x22_5_n_3_g/100,
x22_6_n_3_g = dailywetwt * x22_6_n_3_g/100) %>%
left_join(ptb_all, by = "mrn")
View(dailyoil)
dailytotaloil <- dailyoil %>%
select(mrn, fdrt, x20_5_n_3_g:x22_6_n_3_g) %>%
gather('type', 'gram', x20_5_n_3_g:x22_6_n_3_g) %>%
group_by(mrn, fdrt) %>%
summarise(total_fatty = sum(gram)) %>%
left_join(ptb_all %>%
select(mrn,d100_a_gvhd))
dailytotaloil %>%
filter(  d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'total_fatty', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = '',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
#facet_grid(~ soluble)  +
#scale_color_manual(values = color_key) +
#scale_fill_manual(values = color_key)+
scale_y_sqrt()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
type <- read_csv('../data/10_patients_foods_fiber_type_all.csv')
DTB <- read_csv('../../food_tree/data/152_combined_DTB.csv')
# join with gvhd info of the patients
pts <- read_csv('../../food_tree/data/156_transplant_data.csv') %>%
mutate(d100_a_gvhd = if_else(d100_a_gvhd == 'NE', 'N/E', d100_a_gvhd))
colnames(pts)
pts %>% count(d100_a_gvhd)
dailycode <- DTB %>%
group_by(mrn, fdrt, Food_code) %>%
summarise(dcodefiber = sum(Fibers_g)) %>%
janitor::clean_names()
View(dailycode)
# calculate daily intake of each food code
dailycode <- DTB %>%
group_by(mrn, fdrt, Food_code) %>%
summarise(dcodefiber = sum(Fibers_g)) %>%
janitor::clean_names() %>%
#filter(dcodefiber > 0) %>%
left_join(type, by = "food_code") %>%
ungroup() %>%
relocate(description, .after = 'soluble') %>%
left_join(pts %>% select(mrn, d100_a_gvhd))
View(type)
dailycode
dailycode
dailycode
# calculate daily intake of each food code
dailycode <- DTB %>%
group_by(mrn, fdrt, Food_code) %>%
summarise(dcodefiber = sum(Fibers_g)) %>%
janitor::clean_names() %>%
#filter(dcodefiber > 0) %>%
left_join(type, by = "food_code") %>%
ungroup() %>%
relocate(description, .after = 'soluble') %>%
left_join(pts %>% select(mrn, d100_a_gvhd))
dailycode %>% write_csv('../data/patients_16s_data/11_pt_daily_fiber_type.csv')
dailycode %>% write_csv('../data/11_pt_daily_fiber_type.csv')
key <- read_csv('../../food_tree/data/cleaned_diet_data/food_group_color_key_final.csv', col_types = 'ccccc')
dailyfgfiber <-  DTB %>%
mutate(fgrp1 = str_sub(Food_code, 1, 1)) %>%
group_by(mrn, fdrt, fgrp1) %>%
summarise(dfgfiber = sum(Fibers_g)) %>%
left_join(pts %>% select(mrn, d100_a_gvhd)) %>%
left_join(key %>% select(fgrp1, shortname))
dailyfgfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30) %>%
ggscatter(x = 'fdrt', y = 'dfgfiber',  alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, ylab = 'Daily fiber intake from each group',
#title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key) +
facet_wrap(~ shortname, scales = 'free')
color_key <- c('#42B440','#EC0000')
names(color_key) <- c('N','Y')
dailyfgfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30) %>%
ggscatter(x = 'fdrt', y = 'dfgfiber',  alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, ylab = 'Daily fiber intake from each group',
#title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key) +
facet_wrap(~ shortname, scales = 'free')
ggsave('../data/11_daily_fiber_fg.pdf', width = 8, height = 6)
View(dailycode)
all_types <- dailycode %>%
group_by(mrn, d100_a_gvhd, fdrt, fiber_type) %>%
summarise(gram = sum(dcodefiber)) %>%
ungroup()
View(all_types)
dailytotaldry <- DTB %>%
group_by(mrn, fdrt) %>%
summarise(alldry = sum(dehydrated_weight))
View(dailytotaldry)
all_types <- dailycode %>%
group_by(mrn, d100_a_gvhd, fdrt, fiber_type) %>%
summarise(gram = sum(dcodefiber)) %>%
ungroup() %>% left_join(dailytotaldry)
View(all_types)
all_types
all_types <- dailycode %>%
group_by(mrn, d100_a_gvhd, fdrt, fiber_type) %>%
summarise(gram = sum(dcodefiber)) %>%
ungroup() %>% left_join(dailytotaldry) %>%
mutate(fiber_perc = gram/alldry*100)
all_types
all_types %>%
filter(fdrt %in% -30:30) %>%
ggscatter(x = 'fdrt', y = 'fiber_perc', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE,
add.params = list(color = 'forestgreen', size = 1)) +
facet_grid(~ fiber_type)
ggsave('../data/11_fiber_all_type_daily_intake.pdf', width = 15, height = 5)
all_soluble <- dailycode %>%
group_by(mrn, d100_a_gvhd, fdrt, soluble) %>%
summarise(gram = sum(dcodefiber)) %>%
ungroup()
View(all_soluble)
all_soluble <- dailycode %>%
group_by(mrn, d100_a_gvhd, fdrt, soluble) %>%
summarise(gram = sum(dcodefiber)) %>%
ungroup()%>% left_join(dailytotaldry) %>%
mutate(fiber_perc = gram/alldry*100)
color_key <- c('#42B440','#EC0000')
names(color_key) <- c('N','Y')
all_soluble %>%
filter( fdrt <= 30 & d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'fiber_perc', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
facet_grid(~ soluble)  +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)+
scale_y_sqrt()
ggsave('../data/patients_16s_data/11_fiber_all_soluble_daily_intake_gvhd.pdf', width = 6, height = 4)
ggsave('../data/11_fiber_all_soluble_daily_intake_gvhd.pdf', width = 6, height = 4)
all_soluble %>%
filter( fdrt <= 30 & d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'fiber_perc', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
facet_grid(~ soluble)  +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)+
scale_y_sqrt()
all_types %>%
filter(fdrt <= 30 & d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'fiber_perc', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = 'All fiber types',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key) +
facet_grid(~ fiber_type) +
scale_y_sqrt()
ggsave('../data/patients_16s_data/11_fiber_all_daily_intake_gvhd.pdf', width = 15, height = 4)
ggsave('../data/11_fiber_all_daily_intake_gvhd.pdf', width = 15, height = 4)
all_types %>%
filter(fdrt <= 30 & d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'fiber_perc', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = 'All fiber types',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key) +
facet_grid(~ fiber_type) +
scale_y_sqrt()
all_soluble %>%
filter( fdrt <= 30 & d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'fiber_perc', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
facet_grid(~ soluble)  +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)+
scale_y_sqrt()
all_soluble %>%
filter( fdrt <= 30 & d100_a_gvhd %in% c('Y','N')) %>%
ggscatter(x = 'fdrt', y = 'fiber_perc', alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
facet_grid(~ soluble)  +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)+
scale_y_sqrt()
ggsave('../data/patients_16s_data/11_fiber_all_soluble_daily_intake_gvhd.pdf', width = 6, height = 4)
ggsave('../data/11_fiber_all_soluble_daily_intake_gvhd.pdf', width = 6, height = 4)
DTB %>%
count(d100_a_gvhd)
all_soluble %>%
distinct(mrn) %>%
count(d100_a_gvhd)
all_soluble
all_types %>%
distinct(mrn, d100_a_gvhd) %>%
count(d100_a_gvhd)
View(pts)
pts %>% select(starts_with('da100'))
pts %>% select(starts_with('d100'))
dailytotalfiber <- DTB %>%
group_by(mrn, fdrt) %>%
summarise(dailyfiber = sum(Fibers_g))
dailytotalfiber <- DTB %>%
group_by(mrn, fdrt) %>%
summarise(dailyfiber = sum(Fibers_g)) %>%
ungroup %>%
left_join(pts %>% select(mrn, d100_a_gvhd))
View(dailytotaldry)
View(dailytotalfiber)
dailytotalfiber
dailytotalfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30) %>%
ggscatter(x = 'fdrt', y = 'dailyfiber',  alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, ylab = 'Daily fiber intake from each group',
#title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key) +
facet_wrap(~ shortname, scales = 'free')
dailytotalfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30) %>%
ggscatter(x = 'fdrt', y = 'dailyfiber',  alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, ylab = 'Daily fiber intake from each group',
#title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)
dailytotalfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30) %>%
ggscatter(x = 'fdrt', y = 'dailyfiber',  alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, ylab = 'Daily fiber intake from each group',
#title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)
dailytotalfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30) %>%
ggscatter(x = 'fdrt', y = 'dailyfiber',  alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, ylab = 'Daily fiber intake from each group',
#title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)
dailytotalfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30)
dailytotalfiber %>%
filter( d100_a_gvhd %in% c('Y','N') & fdrt <= 30) %>%
ggscatter(x = 'fdrt', y = 'dailyfiber',  alpha = 0.05, shape = 16,xlab = 'transplant day',
add = "loess", conf.int = TRUE, ylab = 'Daily fiber intake from each group',
#title = 'soluble',
add.params = list(color = 'd100_a_gvhd', size = 1)) +
scale_color_manual(values = color_key) +
scale_fill_manual(values = color_key)
all_types
all_types <- dailycode %>%
group_by(mrn, d100_a_gvhd, fdrt, fiber_type) %>%
summarise(gram = sum(dcodefiber)) %>%
ungroup()
View(dailycode)
??ggpie
tibble(
grp = c('A','B'),
value = c(40,90)
)
tibble(
grp = c('A','B'),
value = c(40,90)
) %>%
ggpie(x = 'value')
