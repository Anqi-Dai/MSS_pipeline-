fam_df <- fam_joined %>%
ungroup() %>%
select(f__Acidaminococcaceae: f__Victivallaceae)
pmv_test <- adonis(fam_df ~ CD8_Conversion_Hot_to_Cold + Manual_Tumor_Buckets + Visit + pid, data=fam_joined, permutations=999, method = 'bray')
pmv_test
# ORR_Responder CD8_Conversion_Hot_to_Cold
?distinctColorPalette
View(beta_meta_amadeus)
View(cts_fil)
cts_meta <- spp %>%
filter(clade_name %in% keepspp) %>%
select(sampleid, clade_name,perc ) %>%
spread(key = 'clade_name', value = 'perc', fill = 0)
View(cts_meta)
cts_meta <- spp %>%
filter(clade_name %in% keepspp) %>%
select(sampleid, clade_name,perc ) %>%
spread(key = 'clade_name', value = 'perc', fill = 0) %>%
full_join(meta_amadeus)
cts_meta_cts <- cts_meta %>%
select(starts_with('k__'))
View(cts_meta_cts)
getOption("mc.cores")
anosim(cts_meta_cts, cts_meta$ORR_Responder, permutations = 999, distance = "bray", strata = NULL,
parallel = 16)
#may be must look at the bl samples between convert of not convert
anosim(cts_meta_cts, cts_meta$ORR_Responder, permutations = 999, distance = "bray", strata = NULL,
parallel = 16)
anosim(cts_meta_cts, cts_meta$CD8_Conversion_Hot_to_Cold, permutations = 999, distance = "bray", strata = NULL,
parallel = 16)
cts_meta
colnames(cts_meta)
colnames(meta_amadeus)
#may be must look at the bl samples between convert of not convert
bl_convert <- cts_meta %>%
filter(Visit == 'BL' & CD8_Conversion_Hot_to_Cold %in% c('N','Y'))
View(bl_convert)
anosim(bl_convert %>% select(starts_with('k__')), bl_convert$CD8_Conversion_Hot_to_Cold, permutations = 999, distance = "bray", strata = NULL,
parallel = 16)
# conclusion: not really
anosim(bl_convert %>% select(starts_with('k__')), bl_convert$CD8_Conversion_Hot_to_Cold, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
View(beta_meta_amadeus)
# look at the Rx samples between convert of not convert
Rx_convert <- cts_meta %>%
filter(Visit == 'Rx' & CD8_Conversion_Hot_to_Cold %in% c('N','Y'))
# look at the Rx samples between convert of not convert
Rx_convert <- cts_meta %>%
filter(Visit == 'Rx' & CD8_Conversion_Hot_to_Cold %in% c('N','Y'))
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_convert %>% select(starts_with('k__')), Rx_convert$CD8_Conversion_Hot_to_Cold, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the bl samples between responder and nonresponder
bl_res <- cts_meta %>%
filter(Visit == 'BL')
# look at the bl samples between responder and nonresponder
bl_res <- cts_meta %>%
filter(Visit == 'BL')
# conclusion: not really a difference between converter and non-converter in BL
anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between convert of not convert
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
View(bl_res)
# look at the bl samples between responder and nonresponder
bl_res <- cts_meta %>%
filter(Visit == 'BL')
# conclusion: not really a difference between converter and non-converter in BL
anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 99, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 9999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 9999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 9999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 9999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
Rx_res_cts <- Rx_res %>% select(starts_with('k__'))
View(Rx_res_cts)
View(Rx_res)
Rx_res_cts <- Rx_res %>% select(sampleid, starts_with('k__'))
Rx_res_cts <- Rx_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_Rx <- vegdist(Rx_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_Rx)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_Rx <- cmdscale(dist_Rx, k = 2)
beta_meta_amadeus_Rx <- bc_Rx %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# reaches borderline sig p value
Rx_res_cts <- Rx_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_Rx <- vegdist(Rx_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_Rx)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_Rx <- cmdscale(dist_Rx, k = 2)
beta_meta_amadeus_Rx <- bc_Rx %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
View(beta_meta_amadeus_Rx)
beta_meta_amadeus_Rx
# look at the Rx samples between responder and nonresponder
Rx_res <- cts_meta %>%
filter(Visit == 'Rx')
# conclusion: not really a difference between converter and non-converter in BL
anosim(Rx_res %>% select(starts_with('k__')), Rx_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
# reaches borderline sig p value
Rx_res_cts <- Rx_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_Rx <- vegdist(Rx_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_Rx)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_Rx <- cmdscale(dist_Rx, k = 2)
beta_meta_amadeus_Rx <- bc_Rx %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
beta_meta_amadeus_Rx %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet') +
labs(title = '') +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
# look at the bl samples between responder and nonresponder
bl_res <- cts_meta %>%
filter(Visit == 'BL')
# conclusion: not really a difference between converter and non-converter in BL
anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
bl_res_cts <- bl_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_bl <- vegdist(bl_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_bl)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_bl <- cmdscale(dist_bl, k = 2)
beta_meta_amadeus_bl <- bc_bl %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
beta_meta_amadeus_bl %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet') +
labs(title = '') +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
bl_res_cts <- bl_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_bl <- vegdist(bl_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_bl)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_bl <- cmdscale(dist_bl, k = 2)
beta_meta_amadeus_bl <- bc_bl %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
beta_meta_amadeus_bl %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet') +
labs(title = '') +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
bl_res_anosim <- anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
beta_meta_amadeus_bl %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet',
title = str_glue('Bl samples only PCoA\npval:{bl_res_anosim$signif} statistic:{round(bl_res_anosim$statistic, 2)}')) +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
bl_res_anosim
beta_meta_amadeus_bl %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet',
title = str_glue('Bl samples only PCoA\npval:{bl_res_anosim$signif} statistic:{round(bl_res_anosim$statistic, 4)}')) +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
bl_res_anosim
# look at the bl samples between responder and nonresponder
bl_res <- cts_meta %>%
filter(Visit == 'BL')
bl_res_anosim <- anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
bl_res_cts <- bl_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_bl <- vegdist(bl_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_bl)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_bl <- cmdscale(dist_bl, k = 2)
beta_meta_amadeus_bl <- bc_bl %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
beta_meta_amadeus_bl %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet',
title = str_glue('Bl samples only PCoA\npval:{bl_res_anosim$signif} statistic:{round(bl_res_anosim$statistic, 4)}')) +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
# look at the bl samples between responder and nonresponder
bl_res <- cts_meta %>%
filter(Visit == 'BL')
bl_res_anosim <- anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
bl_res_cts <- bl_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_bl <- vegdist(bl_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_bl)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_bl <- cmdscale(dist_bl, k = 2)
beta_meta_amadeus_bl <- bc_bl %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
beta_meta_amadeus_bl %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet',
title = str_glue('Bl samples only PCoA\npval:{bl_res_anosim$signif} statistic:{round(bl_res_anosim$statistic, 4)}')) +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
pmv_test <- adonis(fam_df ~ ORR_Responder + Manual_Tumor_Buckets + Visit + pid, data=fam_joined, permutations=999, method = 'bray')
pmv_test
ggsave('../figs/03_bl_pcoa_res.pdf', width = 5, height = 4)
# look at the bl samples between responder and nonresponder
bl_res <- cts_meta %>%
filter(Visit == 'BL')
bl_res_anosim <- anosim(bl_res %>% select(starts_with('k__')), bl_res$ORR_Responder, permutations = 999, distance = "bray", strata = NULL, parallel = 16)
bl_res_cts <- bl_res %>% select(sampleid, starts_with('k__')) %>%
column_to_rownames('sampleid')
dist_bl <- vegdist(bl_res_cts, method = 'bray')
eigen <- ape::pcoa(dist_bl)$values$Eigenvalues
percent_var <- signif(eigen/sum(eigen), 3)*100
bc_bl <- cmdscale(dist_bl, k = 2)
beta_meta_amadeus_bl <- bc_bl %>%
as.data.frame() %>%
rownames_to_column('sampleid')  %>%
inner_join(meta_amadeus)
beta_meta_amadeus_bl %>%
ggscatter(x = 'V1', y = 'V2', color =  'ORR_Responder', palette = 'lancet',
title = str_glue('Bl samples only PCoA\npval:{bl_res_anosim$signif} statistic:{round(bl_res_anosim$statistic, 4)}')) +
xlab(paste0("PC 1 [",percent_var[1],"%]")) +
ylab(paste0("PC 2 [",percent_var[2],"%]")) +
theme(aspect.ratio=1, legend.position = 'right')
ggsave('../figs/03_bl_pcoa_res.pdf', width = 5, height = 4)
knitr::opts_chunk$set(echo = TRUE, message = F)
ptb <- read_csv('../data/input/PICI0025_clinical_2021-10-07/AMADEUS_ClinicalData_20211007.csv')
View(ptb)
View(ptb)
View(ptb)
ptb <- read_csv('../data/input/PICI0025_clinical_2021-10-07/AMADEUS_ClinicalData_20211007.csv')
